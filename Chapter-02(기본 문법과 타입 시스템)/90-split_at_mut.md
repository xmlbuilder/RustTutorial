# split_at_mut

- split_at_mut ëŠ” ê°€ë³€ ìŠ¬ë¼ì´ìŠ¤ë¥¼ ë‘ ê°œì˜ ê°€ë³€ ìŠ¬ë¼ì´ìŠ¤ë¡œ **ì•ˆì „í•˜ê²Œ** ìª¼ê°œì£¼ëŠ” ë©”ì„œë“œ.
- í•µì‹¬ì€: 
    - í•˜ë‚˜ì˜ &mut [T]ì—ì„œ, ì„œë¡œ ê²¹ì¹˜ì§€ ì•ŠëŠ” ë‘ ê°œì˜ &mut [T]ë¥¼ ë§Œë“œëŠ” ìœ ì¼í•˜ê²Œ ì•ˆì „í•œ ë°©ë²• ì¤‘ í•˜ë‚˜.

## 1. ì‹œê·¸ë‹ˆì²˜ì™€ ê¸°ë³¸ ë™ì‘
```rust
impl<T> [T] {
    pub fn split_at_mut(&mut self, mid: usize) 
        -> (&mut [T], &mut [T])
}
```
- self: &mut [T] (ê°€ë³€ ìŠ¬ë¼ì´ìŠ¤)
- mid: ë‚˜ëˆŒ ì¸ë±ìŠ¤
- ë°˜í™˜: (left, right)
  - left: &mut self[0..mid]
  - right: &mut self[mid..self.len()]
- ì˜ˆ:
```rust
let mut data = [10, 20, 30, 40, 50];
let (left, right) = data.split_at_mut(2);

assert_eq!(left,  &mut [10, 20]);
assert_eq!(right, &mut [30, 40, 50]);

left[0] = 100;
right[2] = 500;

assert_eq!(data, [100, 20, 30, 40, 500]);
```


## 2. ì™œ ì¤‘ìš”í•œê°€? 
- **ê²¹ì¹˜ì§€ ì•ŠëŠ” ë‘ ê°œì˜ &mut** ì„ ë§Œë“œëŠ” ìœ ì¼í•œ ê¸¸
- Rustì—ì„œëŠ” ê°™ì€ ë©”ëª¨ë¦¬ ì˜ì—­ì— ëŒ€í•´ ë™ì‹œì— ë‘ ê°œì˜ &mut ì°¸ì¡°ë¥¼ ê°€ì§€ë©´ ì•ˆ ë¨.
- ê·¸ë˜ì„œ ì´ëŸ° ì½”ë“œëŠ” ë¶ˆê°€ëŠ¥:
```rust
let mut data = [1, 2, 3, 4];
let a = &mut data[0..2];
let b = &mut data[1..4]; // ê²¹ì¹¨ â†’ ì»´íŒŒì¼ ì—ëŸ¬
```
- í•˜ì§€ë§Œ ê²¹ì¹˜ì§€ ì•ŠëŠ” ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê±´ í•©ë¦¬ì 
    - ê·¸ê±¸ ì•ˆì „í•˜ê²Œ ë³´ì¥í•´ì£¼ëŠ” ê²Œ split_at_mut.
```rust
let mut data = [1, 2, 3, 4];
let (a, b) = data.split_at_mut(2);
// a: [1, 2], b: [3, 4] â†’ ì ˆëŒ€ ê²¹ì¹˜ì§€ ì•ŠìŒ
```

- ì»´íŒŒì¼ëŸ¬ëŠ” split_at_mutê°€ ê²¹ì¹˜ì§€ ì•ŠëŠ” ë‘ ìŠ¬ë¼ì´ìŠ¤ë§Œ ë°˜í™˜í•œë‹¤ëŠ” ê±¸ ì•Œê³  ìˆì–´ì„œ,  
    ì´ ë‘ &mutë¥¼ ë™ì‹œì— ì‚¬ìš©í•˜ëŠ” ê±¸ í—ˆìš©.

## 3. ì¸ë±ìŠ¤ ê·œì¹™
- midëŠ” 0..=len ë²”ìœ„ì—¬ì•¼ í•´.
  - mid == 0 â†’ ([], ì „ì²´)
  - mid == len â†’ (ì „ì²´, [])
- ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ íŒ¨ë‹‰:
```rust
let mut data = [1, 2, 3];
let _ = data.split_at_mut(4); // ëŸ°íƒ€ì„ íŒ¨ë‹‰
```

## 4. ìì£¼ ì“°ëŠ” íŒ¨í„´ë“¤
### 4.1. ìŠ¬ë¼ì´ìŠ¤ë¥¼ ì•/ë’¤ë¡œ ë‚˜ëˆ ì„œ ë™ì‹œì— ìˆ˜ì •
```rust
fn normalize_two_parts(slice: &mut [f64], mid: usize) {
    let (head, tail) = slice.split_at_mut(mid);

    for x in head.iter_mut() {
        *x *= 0.5;
    }
    for x in tail.iter_mut() {
        *x *= 2.0;
    }
}
```
### 4.2. ì¸ë±ìŠ¤ ë‘ ê°œë¥¼ ë™ì‹œì— ê°€ë³€ ì°¸ì¡°í•˜ê³  ì‹¶ì„ ë•Œ
- ì˜ˆë¥¼ ë“¤ì–´, ë‘ ì›ì†Œë¥¼ swapí•˜ê±°ë‚˜ ë™ì‹œì— ìˆ˜ì •í•˜ê³  ì‹¶ì€ë°,  
    ë‹¨ìˆœ ì¸ë±ì‹±ìœ¼ë¡œëŠ” aliasing ë•Œë¬¸ì— ë§‰í ë•Œ:
```rust
fn add_pair(slice: &mut [i32], i: usize, j: usize) {
    assert!(i < slice.len() && j < slice.len());
    assert!(i != j);

    let (a, b) = if i < j {
        let (left, right) = slice.split_at_mut(j);
        (&mut left[i], &mut right[0])
    } else {
        let (left, right) = slice.split_at_mut(i);
        (&mut right[0], &mut left[j])
    };

    *a += *b;
}
```

- ì—¬ê¸°ì„œ í•µì‹¬ì€:
    - split_at_mutë¡œ ìŠ¬ë¼ì´ìŠ¤ë¥¼ ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ„ë©´
        - ì„œë¡œ ë‹¤ë¥¸ ë¶€ë¶„ì—ì„œ ê°ê° í•˜ë‚˜ì”© &mutë¥¼ êº¼ë‚¼ ìˆ˜ ìˆë‹¤.
    - ì´ ë°©ì‹ì€ unsafe ì—†ì´ ë‘ ì¸ë±ìŠ¤ë¥¼ ë™ì‹œì— &mutë¡œ ë‹¤ë£¨ëŠ” ì •ì„ íŒ¨í„´.

## 5. split_at vs split_at_mut
- split_at:
    - &[T] â†’ (&[T], &[T])
    - ë¶ˆë³€ ìŠ¬ë¼ì´ìŠ¤
- split_at_mut:
    - &mut [T] â†’ (&mut [T], &mut [T])
    - ê°€ë³€ ìŠ¬ë¼ì´ìŠ¤
- ë¶ˆë³€ ë²„ì „ì€ aliasing ë¬¸ì œê°€ ì—†ì–´ì„œ ëœ ì¤‘ìš”í•˜ì§€ë§Œ,  
    ê°€ë³€ ë²„ì „ì€ **ì•ˆì „í•œ ì´ì¤‘ ê°€ë³€ ì°¸ì¡°** ë¥¼ ìœ„í•´ ì‚¬ì‹¤ìƒ í•„ìˆ˜ ë„êµ¬.

## 6. í•œ ì¤„ ìš”ì•½
- split_at_mutëŠ”
    í•˜ë‚˜ì˜ ê°€ë³€ ìŠ¬ë¼ì´ìŠ¤ë¥¼, ì„œë¡œ ê²¹ì¹˜ì§€ ì•ŠëŠ” ë‘ ê°œì˜ ê°€ë³€ ìŠ¬ë¼ì´ìŠ¤ë¡œ ë‚˜ëˆ„ëŠ” ì•ˆì „í•œ ë°©ë²•ì´ê³ ,  
    **ë‘ ë¶€ë¶„ì„ ë™ì‹œì— ìˆ˜ì •í•´ì•¼ í•˜ëŠ”** ëª¨ë“  ìƒí™©ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ë– ì˜¬ë ¤ì•¼ í•˜ëŠ” ë„êµ¬.  

---
## push ë¶ˆê°€
- split_at_mutë¡œ ì–»ì€ a, bëŠ” ìŠ¬ë¼ì´ìŠ¤ì´ê¸° ë•Œë¬¸ì— push ìì²´ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
  - ì¦‰, a.push(...)ë„ ì•ˆ ë˜ê³  b.push(...)ë„ ì•ˆ ë¨.
  - ê·¸ë˜ì„œ ë©”ëª¨ë¦¬ê°€ ê¹¨ì§ˆ ì¼ ìì²´ê°€ ì—†ë‹¤.

### ğŸ“Œ ì™œ pushê°€ ë¶ˆê°€ëŠ¥í•œê°€
- Rustì˜ ìŠ¬ë¼ì´ìŠ¤ íƒ€ì…ì€:
```rust
&mut [T]
```
- ì´ê³ , ì´ íƒ€ì…ì€:
  - ê¸¸ì´ê°€ ê³ ì •ë˜ì–´ ìˆê³ 
  - capacity ê°œë…ì´ ì—†ê³ 
  - ì¬í• ë‹¹ì´ ë¶ˆê°€ëŠ¥í•˜ê³ 
  - push/pop ê°™ì€ ë™ì‘ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤
- ì¦‰, ìŠ¬ë¼ì´ìŠ¤ëŠ” **ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë©”ëª¨ë¦¬ ì¡°ê°ì„ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„° + ê¸¸ì´** ì¼ ë¿.
- ê·¸ë˜ì„œ:
```rust
let (a, b) = data.split_at_mut(3);
a.push(10); // âŒ ì»´íŒŒì¼ ì—ëŸ¬
b.push(20); // âŒ ì»´íŒŒì¼ ì—ëŸ¬
```
- ì´ê±´ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ë§‰íŒë‹¤.

## ğŸ“Œ ì™œ RustëŠ” ì´ëŸ° ìœ„í—˜ì„ ì›ì²œ ì°¨ë‹¨í• ê¹Œ
- ë§Œì•½ ìŠ¬ë¼ì´ìŠ¤ì—ì„œ pushê°€ ê°€ëŠ¥í–ˆë‹¤ë©´:
  - ë©”ëª¨ë¦¬ ì¬í• ë‹¹ì´ ì¼ì–´ë‚˜ì•¼ í•˜ê³ 
  - ê·¸ ìˆœê°„ aì™€ bê°€ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°ê°€ ë¬´íš¨í™”ë˜ê³ 
  - use-after-free, double free, memory corruption ë°œìƒ
- ì¦‰, C/C++ì—ì„œ í”íˆ í„°ì§€ëŠ” ë©”ëª¨ë¦¬ íŒŒê´´ ë²„ê·¸ê°€ ê·¸ëŒ€ë¡œ ë°œìƒí•œë‹¤.
  - RustëŠ” ì´ëŸ° ìœ„í—˜ì„ íƒ€ì… ì‹œìŠ¤í…œìœ¼ë¡œ ì›ì²œ ì°¨ë‹¨í•œë‹¤.

## ğŸ“Œ ê·¸ëŸ¼ push í•˜ê³  ì‹¶ìœ¼ë©´ ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜
- ìŠ¬ë¼ì´ìŠ¤ê°€ ì•„ë‹ˆë¼ Vecì´ì–´ì•¼ í•´.
- ì˜ˆ:
```rust
let mut v = vec![1, 2, 3];
v.push(4); // OK
```
- í•˜ì§€ë§Œ split_at_mutëŠ” Vecì´ ì•„ë‹ˆë¼ ìŠ¬ë¼ì´ìŠ¤ë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ push ë¶ˆê°€.

---





