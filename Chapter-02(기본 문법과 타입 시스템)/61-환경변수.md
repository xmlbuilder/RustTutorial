# 환경 변수

✅ 대안 1: config 크레이트 (추천)
- 다양한 포맷 지원: .json, .toml, .yaml, .ini
- .properties는 직접 지원하지 않지만 구조가 비슷한 .ini 또는 .toml로 대체 가능

```
# Cargo.toml
[dependencies]
config = "0.13"
```

```rust
use config::{Config, File};

fn main() {
    let settings = Config::builder()
        .add_source(File::with_name("Settings")) // Settings.toml 또는 Settings.ini
        .build()
        .unwrap();

    let username: String = settings.get("username").unwrap();
    println!("Username: {}", username);
}
```

```rust

   #[test]
    fn test_config_mem()
    {
        let settings = Config::builder()
            .add_source(config::File::from_str(
                r#"
            username = "junghwan"
            theme = "dark"
            "#,
                config::FileFormat::Toml,
            ))
            .build()
            .unwrap();

        let username: String = settings.get("username").unwrap();
        println!("Username: {}", username);

    }
```



## ✅ 대안 2: 직접 .properties 파싱
.properties 파일은 단순한 key=value 형식이므로, Rust의 표준 라이브러리로 직접 파싱할 수 있음:
```rust
use std::fs::File;
use std::io::{BufRead, BufReader};
use std::collections::HashMap;

fn load_properties(path: &str) -> HashMap<String, String> {
    let file = File::open(path).expect("파일 열기 실패");
    let reader = BufReader::new(file);
    let mut map = HashMap::new();

    for line in reader.lines() {
        if let Ok(line) = line {
            if let Some((key, value)) = line.split_once('=') {
                map.insert(key.trim().to_string(), value.trim().to_string());
            }
        }
    }

    map
}

fn main() {
    let props = load_properties("config.properties");
    if let Some(username) = props.get("username") {
        println!("Username: {}", username);
    }
}
```

## 📌 Rust에서 Java `Properties` 유사 기능 요약

| 기능 유형               | Rust에서의 구현 또는 대안 크레이트             |
|--------------------------|-----------------------------------------------|
| `.properties` 파일 파싱  | `split_once` + `HashMap`으로 직접 구현         |
| 설정 파일 통합 관리      | [`config`](https://docs.rs/config/latest/config/) 크레이트 (TOML, JSON, YAML 등 지원) |
| 시스템 환경 변수 조회    | `std::env::var`, `std::env::vars()`            |

---


# 🧠 1. 자체 환경 변수 (std::env)
Rust 표준 라이브러리의 std::env 모듈을 사용하면 OS 환경 변수에 접근할 수 있음.

## ✅ 주요 메서드 요약: std::env

| 메서드                        | 설명 |
|------------------------------|------|
| `env::var("KEY")`            | 환경 변수 `KEY`의 값을 가져옴 → `Result<String, VarError>` 반환 |
| `env::vars()`                | 모든 환경 변수의 `(key, value)` 쌍을 반복자로 반환 |
| `env::set_var("KEY", "VALUE")` | 런타임 중 환경 변수 설정 (현재 프로세스에만 적용) |
| `env::remove_var("KEY")`     | 환경 변수 제거 (현재 프로세스에서만 제거됨) |

## ✅ 예제
```rust
use std::env;

fn main() {
    env::set_var("APP_MODE", "debug");

    if let Ok(mode) = env::var("APP_MODE") {
        println!("앱 모드: {}", mode);
    }

    for (key, value) in env::vars() {
        println!("{} = {}", key, value);
    }
}
```

📌 환경 변수는 운영체제 수준에서 설정되거나, 실행 시 커맨드라인에서 지정할 수 있음:
```
APP_MODE=release cargo run
```

## 📦 2. .env 파일 기반 설정: dotenvy 크레이트
.env 파일은 환경 변수들을 파일로 관리할 수 있게 해주는 방식.   
dotenvy는 이를 Rust에서 쉽게 로딩할 수 있도록 도와주는 크레이트입니다.

### ✅ 설치
```
# Cargo.toml
[dependencies]
dotenvy = "0.15"
```

### ✅ .env 파일 예시
```
APP_MODE=debug
DATABASE_URL=postgres://user:pass@localhost/db
```

### ✅ 사용 예제
```rust
use dotenvy::dotenv;
use std::env;

fn main() {
    dotenv().ok(); // .env 파일 로딩

    let mode = env::var("APP_MODE").unwrap_or("default".to_string());
    println!("앱 모드: {}", mode);
}
```

- dotenv() 호출 시 .env 파일을 읽고 std::env에 등록
- 이후에는 env::var()로 일반 환경 변수처럼 접근 가능

## 📌 요약 비교
### 📌 Rust 환경 설정 방식 비교

| 방식             | 설명 |
|------------------|------|
| `std::env`       | OS 환경 변수 직접 접근 및 설정 |
| `dotenvy` 크레이트 | `.env` 파일을 로딩하여 환경 변수로 등록 |

---



