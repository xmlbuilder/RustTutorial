# Vec 유용한 함수
- Rust의 Vec는 단순한 동적 배열이 아니라 메모리·성능·안전성까지 고려된 고급 컨테이너라서,  
    몇 가지 함수만 제대로 이해해도 코드 품질이 확 달라짐.
- 특히 메모리 민감한 코드를 다루는 사람에게는 fill, truncate, resize,  with_capacity 같은 함수들이 굉장히 중요.

## 🔷 1) truncate() — 길이를 줄이되, 메모리는 그대로 유지
```rust
let mut v = vec![1,2,3,4,5];
v.truncate(3);
println!("{:?}", v); // [1,2,3]
```

### ✔ 특징
- 길이(len)만 줄이고 capacity는 그대로 유지
- 잘린 요소들은 drop 호출됨
- 메모리를 다시 할당하지 않음 → 매우 빠름
### ✔ 언제 쓰나?
- 삭제 후 개수 줄일 때
- 사용하지 않는 남은 공간 잘라낼 때
- temporary buffer를 재사용할 때

## 🔷 2) resize() — 길이를 늘리거나 줄인다
```rust
let mut v = vec![1,2];
v.resize(5, 0);
println!("{:?}", v); // [1,2,0,0,0]
```

### ✔ 특징
- 길이가 늘어나면 새 요소를 clone하여 채움
- 줄어들면 truncate와 동일
### ✔ 언제 쓰나?
- 작업 버퍼를 일정 크기로 맞출 때
- 작업 시 임시 벡터 확장

## 🔷 3) fill() — 모든 요소를 동일한 값으로 채움
- Rust 1.50 이후 지원.
```rust
let mut v = vec![1,2,3];
v.fill(9);
println!("{:?}", v); // [9,9,9]
```

### ✔ 특징
- 길이는 그대로
- 모든 요소를 동일한 값으로 덮어씀
- 매우 빠름 (memcpy 수준)
### ✔ 언제 쓰나?
- 에러 버퍼 초기화
- 반복 루프에서 매번 새 Vec 만들지 않고 재사용할 때

### 🔷 4) clear() — 길이를 0으로 만들지만 capacity 유지
```rust
let mut v = vec![1,2,3];
v.clear();
println!("{:?}", v); // []
```

### ✔ 특징
- truncate(0)과 동일
- capacity는 그대로 → 재사용 가능
### ✔ 언제 쓰나?
- 반복 루프에서 임시 벡터를 재사용할 때
- allocation 비용을 줄이고 싶을 때

## 🔷 5) shrink_to_fit() — capacity를 len에 맞게 줄임
```rust
let mut v = vec![1,2,3];
v.truncate(1);
v.shrink_to_fit();
```

### ✔ 특징
- 메모리를 실제로 줄임
- 필요할 때만 사용 (비용 있음)
### ✔ 언제 쓰나?
- 제거 후 데이터가 많이 줄었을 때
- 제거 후 메모리 최적화

## 🔷 6) with_capacity() — 미리 메모리 확보
```rust
let mut v = Vec::with_capacity(1000);
```

### ✔ 특징
- push 시 재할당 발생하지 않음
- 성능 최적화에 매우 중요
### ✔ 언제 쓰나?
- knot insertion / removal에서 new_pw, new_u 같은 벡터를 만들 때
- 반복적으로 push가 많은 알고리즘

## 🔷 7) reserve() / reserve_exact()
```rust
v.reserve(100);        // 여유 있게 확보
v.reserve_exact(100);  // 정확히 확보
```

### ✔ 언제 쓰나?
- 반복 루프에서 push가 많을 때
- 재할당을 피하고 싶을 때

## 🔷 8) extend_from_slice() — 슬라이스 복사
```rust
let mut v = vec![1];
v.extend_from_slice(&[2,3,4]);
```

### ✔ 언제 쓰나?
- knot vector 복사
- control point 배열 확장
- surface row/column 복사

## 🔷 9) copy_from_slice() — 동일 길이일 때 빠른 복사
```rust
let mut a = [0; 3];
let b = [1,2,3];
a.copy_from_slice(&b);
```

### ✔ 언제 쓰나?
- basis function min/max 복사
- error buffer 복사
- 매우 빠름 (memcpy 수준)

## 🔷 10) retain() — 조건에 맞는 요소만 남김
```rust
v.retain(|x| *x > 0);
```

## ✔ 언제 쓰나?
- knot vector에서 특정 knot 제거
- control point 필터링

## 🔥 중요한 함수들
- 코드 기준으로 보면:
### ✔ truncate()
- knot 제거 후 control point / knot vector 줄일 때 필수
### ✔ fill()
- 에러 버퍼 초기화에 최적
### ✔ with_capacity()
- 큰 벡터를 미리 확보
### ✔ copy_from_slice()
- 사이즈가 같을 때 복사할 때 매우 빠름
### ✔ clear()
- 임시 벡터 재사용
- 이 다섯 개만 잘 써도 성능이 20~40%는 좋아진다.

---



