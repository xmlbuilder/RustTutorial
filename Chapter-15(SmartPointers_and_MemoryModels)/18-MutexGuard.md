# MutexGuard
Rustì˜ `Mutex`ì™€ `MutexGuard` ëŠ” ë™ì‹œì„± í”„ë¡œê·¸ë˜ë°ì—ì„œ ë§¤ìš° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.  
íŠ¹íˆ `MutexGuard` ëŠ” ì´ˆë³´ìë“¤ì´ í—·ê°ˆë¦¬ê¸° ì‰¬ìš´ ê°œë…ì´ì§€ë§Œ, ì´í•´í•˜ë©´ Rustì˜ ì•ˆì „ì„±ê³¼ í¸ë¦¬í•¨ì´ ì–¼ë§ˆë‚˜ ê°•ë ¥í•œì§€ ì‹¤ê°í•˜ê²Œ ë©ë‹ˆë‹¤.  
ì•„ë˜ì— ìì„¸íˆ ì„¤ëª….

## ğŸ” Mutex vs MutexGuard ì°¨ì´ì 

| í•­ëª©                | Mutex<T>                                                   | MutexGuard                                              |
|---------------------|-------------------------------------------------------------|----------------------------------------------------------|
| ì—­í•                 | ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ëŠ” ë½ êµ¬ì¡°ì²´                                  | ë½ì„ íšë“í•œ í›„ ì•ˆì „í•˜ê²Œ ë°ì´í„°ë¥¼ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” í•¸ë“¤     |
| ìƒì„± ë°©ì‹           | `Mutex::new(data)`                                          | `mutex.lock().unwrap()`ìœ¼ë¡œ ìƒì„±ë¨                      |
| ë°ì´í„° ì ‘ê·¼ ë°©ì‹     | ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€                                               | `*guard` ë˜ëŠ” `guard.method()`ë¡œ ì ‘ê·¼ ê°€ëŠ¥              |
| Drop ì‹œ ë™ì‘        | ì•„ë¬´ ì¼ë„ í•˜ì§€ ì•ŠìŒ                                          | ìŠ¤ì½”í”„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ìœ¼ë¡œ ë½ í•´ì œë¨                    |
| ì•ˆì „ì„±              | ë°ì´í„° ë³´í˜¸ë§Œ ë‹´ë‹¹                                           | ë³´í˜¸ëœ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ ë‹¤ë£¨ëŠ” ì±…ì„ì„ ê°€ì§             |
| ì‚¬ìš© ì˜ˆ             | `let m = Mutex::new(0);`                                    | `let mut g = m.lock().unwrap(); *g += 1;`               |

## ğŸ¯ í•µì‹¬ ì°¨ì´
- `Mutex` ëŠ” `ë½ì„ ì œê³µí•˜ëŠ” êµ¬ì¡°ì²´`
- `MutexGuard` ëŠ” ë½ì„ íšë“í•œ í›„ `ë°˜í™˜ë˜ëŠ” í•¸ë“¤` ë¡œ, ì‹¤ì œ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ

## ğŸ”“ lock() í˜¸ì¶œê³¼ MutexGuardì˜ ê´€ê³„
```rust
let mutex = Mutex::new(123);
let guard = mutex.lock().unwrap(); // guardëŠ” MutexGuard<i32>
println!("{}", *guard); // 123
```

## ğŸ” ì™œ lock()ì„ í˜¸ì¶œí•´ì•¼ í•˜ëŠ”ê°€?
- Mutex<T>ëŠ” `ì§ì ‘ ë°ì´í„°ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŒ`
- `lock()` ì„ í˜¸ì¶œí•´ì•¼ `MutexGuard<T>` ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ
- MutexGuardëŠ” ë‚´ë¶€ì ìœ¼ë¡œ Deref íŠ¸ë ˆì´íŠ¸ë¥¼ êµ¬í˜„í•˜ê³  ìˆì–´ì„œ `*guard` ë¡œ ì‹¤ì œ `ë°ì´í„°ì— ì ‘ê·¼` ê°€ëŠ¥

## ğŸ§  ì™œ lock() ì´í›„ì— ë‹¤ì‹œ lock() í˜¸ì¶œí•  í•„ìš”ê°€ ì—†ëŠ”ê°€?
- lock()ì„ í˜¸ì¶œí•˜ë©´ ë½ì„ íšë“í•œ ìƒíƒœê°€ ë˜ê³ , MutexGuardê°€ ë°˜í™˜ë¨
- MutexGuardê°€ ìŠ¤ì½”í”„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ìœ¼ë¡œ ë½ì´ í•´ì œë¨ (RAII íŒ¨í„´)
- ë”°ë¼ì„œ `MutexGuard` ë¥¼ ê°€ì§€ê³  ìˆëŠ” ë™ì•ˆì—ëŠ” `ë½ì´ ìœ ì§€` ë˜ë©°, ë‹¤ì‹œ lock()ì„ í˜¸ì¶œí•  í•„ìš”ê°€ ì—†ìŒ

```rust
fn do_something(mutex: &Mutex<i32>) {
    let mut guard = mutex.lock().unwrap(); // ë½ íšë“
    *guard += 1;                           // ì•ˆì „í•˜ê²Œ ìˆ˜ì •
} // guard drop â†’ ìë™ìœ¼ë¡œ ë½ í•´ì œ
```

## ğŸ§© MutexGuardì˜ íŠ¹ì§•
- Derefì™€ DerefMut íŠ¸ë ˆì´íŠ¸ë¥¼ êµ¬í˜„ â†’ *guard ë˜ëŠ” guard.method()ë¡œ ì§ì ‘ ì ‘ê·¼ ê°€ëŠ¥
- Drop íŠ¸ë ˆì´íŠ¸ë¥¼ êµ¬í˜„ â†’ ìŠ¤ì½”í”„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ìœ¼ë¡œ ë½ í•´ì œ
- MutexGuardëŠ” ë½ì„ ì†Œìœ í•œ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ë¯€ë¡œ, ì´ê±¸ ê°€ì§€ê³  ìˆëŠ” ë™ì•ˆ ë‹¤ë¥¸ ìŠ¤ë ˆë“œëŠ” ì ‘ê·¼ ë¶ˆê°€

## ğŸ§ª ì‹¤ì „ ì˜ˆì‹œ
```rust
use std::sync::{Arc, Mutex};
use std::thread;

fn main() {
    let counter = Arc::new(Mutex::new(0));

    let mut handles = vec![];

    for _ in 0..10 {
        let counter = Arc::clone(&counter);
        let handle = thread::spawn(move || {
            let mut num = counter.lock().unwrap(); // MutexGuard<i32>
            *num += 1;
        });
        handles.push(handle);
    }

    for handle in handles {
        handle.join().unwrap();
    }

    println!("Result: {}", *counter.lock().unwrap());
}
```
- lock()ì„ í˜¸ì¶œí•˜ë©´ MutexGuardë¥¼ ì–»ê³ , *num += 1ë¡œ ì•ˆì „í•˜ê²Œ ê°’ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.  
- MutexGuardëŠ” ìŠ¤ì½”í”„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ìœ¼ë¡œ `drop` ë˜ì–´ ë½ì´ í•´ì œë©ë‹ˆë‹¤.

## âœ… ìš”ì•½
- Mutex<T>ëŠ” ë½ì„ ì œê³µí•˜ëŠ” êµ¬ì¡°ì²´
- lock()ì„ í˜¸ì¶œí•˜ë©´ MutexGuard<T>ê°€ ë°˜í™˜ë˜ì–´ ì•ˆì „í•˜ê²Œ ë°ì´í„°ì— ì ‘ê·¼ ê°€ëŠ¥
- MutexGuardëŠ” ë½ì„ ì†Œìœ í•˜ë©°, ìŠ¤ì½”í”„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ìœ¼ë¡œ í•´ì œë¨
- lock() ì´í›„ì—ëŠ” ë‹¤ì‹œ lock()ì„ í˜¸ì¶œí•  í•„ìš” ì—†ìŒ
- Rustì˜ RAII íŒ¨í„´ ë•ë¶„ì— ëª…ì‹œì ì¸ unlockì´ í•„ìš” ì—†ìŒ

---
