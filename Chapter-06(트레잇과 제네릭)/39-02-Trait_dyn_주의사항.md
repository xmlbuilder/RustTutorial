# dyn trait
- Rustì—ì„œ trait ê°ì²´(&dyn Trait) ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì§€ì¼œì•¼ í•˜ëŠ” ë¬¸ë²• ê·œì¹™ì´ ìˆëŠ”ë°,
- ê·¸ í•µì‹¬ì´ ë°”ë¡œ **self íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” ë©”ì„œë“œëŠ” trait objectì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤**ëŠ” ì . 

## ğŸ“˜ Rust Trait ê°ì²´(&dyn Trait) ë¬¸ë²• ì •ë¦¬
-  **self ì—†ëŠ” ë©¤ë²„ëŠ” í—ˆìš©ë˜ì§€ ì•ŠëŠ”ë‹¤**

### ğŸ§© 1. Trait ê°ì²´ë€?
- &dyn Trait ë˜ëŠ” Box<dyn Trait> í˜•íƒœë¡œ ëŸ°íƒ€ì„ ë‹¤í˜•ì„±(dynamic dispatch) ì„ ì œê³µí•˜ëŠ” Rustì˜ ê¸°ëŠ¥.
- C++/Javaì˜ **ìƒì† ê¸°ë°˜ ë‹¤í˜•ì„±** ê³¼ ë¹„ìŠ·í•œ ì—­í• ì„ í•œë‹¤.

### ğŸš« 2. Trait ê°ì²´ì—ì„œ ê¸ˆì§€ë˜ëŠ” ë©”ì„œë“œ í˜•íƒœ
- Trait ê°ì²´ë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ëª¨ë“  ë©”ì„œë“œê°€ ë°˜ë“œì‹œ self íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì ¸ì•¼ í•œë‹¤.
- âŒ ê¸ˆì§€ë˜ëŠ” í˜•íƒœ
```rust
trait MyTrait {
    fn foo();          // self ì—†ìŒ â†’ trait object ë¶ˆê°€
    fn bar(x: i32);    // self ì—†ìŒ â†’ trait object ë¶ˆê°€
}
```
- ì´ëŸ° ë©”ì„œë“œëŠ” ê°ì²´ì™€ ë¬´ê´€í•œ ì •ì  ë””ìŠ¤íŒ¨ì¹˜(static dispatch) ë¥¼ ìš”êµ¬í•˜ê¸° ë•Œë¬¸ì— trait objectë¡œ ë§Œë“¤ ìˆ˜ ì—†ë‹¤.

### âœ… 3. í—ˆìš©ë˜ëŠ” ë©”ì„œë“œ í˜•íƒœ
- ì•„ë˜ì²˜ëŸ¼ ë°˜ë“œì‹œ self, &self, &mut self ì¤‘ í•˜ë‚˜ë¥¼ í¬í•¨í•´ì•¼ í•œë‹¤.
```rust
trait MyTrait {
    fn foo(&self);          // OK
    fn bar(&mut self);      // OK
    fn baz(self);           // OK
}
```


### ğŸ§  4. ì™œ self ì—†ëŠ” ë©”ì„œë“œëŠ” ì•ˆ ë ê¹Œ?
- Trait ê°ì²´ëŠ” ëŸ°íƒ€ì„ì— ì‹¤ì œ íƒ€ì…ì„ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, ë©”ì„œë“œ í˜¸ì¶œì€ ë°˜ë“œì‹œ vtable(ê°€ìƒ í•¨ìˆ˜ í…Œì´ë¸”) ì„ í†µí•´ ì´ë£¨ì–´ì§„ë‹¤.
- ê·¸ëŸ°ë° self ì—†ëŠ” ë©”ì„œë“œëŠ”:
- ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì™€ ë¬´ê´€í•œ **ì •ì  ë©”ì„œë“œ** ì²˜ëŸ¼ ë™ì‘í•´ì•¼ í•˜ê³ 
  - vtableì„ ì‚¬ìš©í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— trait objectë¡œ ë§Œë“¤ ìˆ˜ ì—†ë‹¤.

### ğŸ“ 5. ì˜ˆì‹œ: ì˜¬ë°”ë¥¸ trait object ì‚¬ìš©
- âœ” ì˜¬ë°”ë¥¸ ì˜ˆ
```rust
trait Animal {
    fn speak(&self);
}
```
```rust
struct Dog;
impl Animal for Dog {
    fn speak(&self) {
        println!("Woof!");
    }
}
```
```rust
fn main() {
    let a: &dyn Animal = &Dog;
    a.speak();
}
```

- âœ– self ì—†ëŠ” ë©”ì„œë“œê°€ ìˆìœ¼ë©´ ì»´íŒŒì¼ ì˜¤ë¥˜
```rust
trait Animal {
    fn speak(&self);
    fn species() -> &'static str; // âŒ trait object ë¶ˆê°€
}
```

## ğŸ“Œ ìš”ì•½ ë¬¸ë²• ê·œì¹™
| í•­ëª©                 | ë‚´ìš©                                      |
|----------------------|-------------------------------------------|
| trait ê°ì²´ ìƒì„± ì¡°ê±´ | ëª¨ë“  ë©”ì„œë“œê°€ self íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì ¸ì•¼ í•¨   |
| í—ˆìš©ë˜ëŠ” self í˜•íƒœ   | self / &self / &mut self                  |
| ê¸ˆì§€ë˜ëŠ” ë©”ì„œë“œ í˜•íƒœ | fn foo();  fn foo(x: i32);                |
| ì´ìœ                  | self ì—†ëŠ” ë©”ì„œë“œëŠ” vtable ê¸°ë°˜ í˜¸ì¶œ ë¶ˆê°€  |

---




