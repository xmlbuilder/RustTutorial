# NLM
Non-local Means(NLM)는 영상이나 신호의 잡음을 제거하는 알고리즘으로,  
단순히 주변 픽셀 평균을 쓰는 ‘local mean’ 방식과 달리 영상 전체에서 유사한 패치를 찾아 평균을 내는 방법입니다.  
따라서 잡음을 줄이면서도 텍스처나 세부 구조를 잘 보존할 수 있습니다.  

## 📌 핵심 개념
- Local Mean 필터: 특정 픽셀 주변(예: 3×3 윈도우)의 값들을 평균 → 잡음은 줄지만 경계나 텍스처가 흐려짐.
- Non-local Means 필터:
  - 관심 픽셀 주변의 작은 패치(예: 5×5)를 기준으로,
  - 영상 전체에서 비슷한 패치를 찾아 가중 평균을 계산.
  - 유사도가 높은 패치일수록 더 큰 가중치를 부여.

## 📐 수식 (연속형 정의)
```
u(p) = (1 / C(p)) * ∫_Ω v(q) * f(p,q) dq
```
- u(p) : 필터링된 값 (출력 영상)
- v(q) : 원본 영상 값
- f(p,q) : 가중치 함수 (픽셀 p와 q의 패치 유사도)
- C(p) : 정규화 상수, ∫ f(p,q) dq

- 이산형(픽셀 기반) 표현:
```
u(p) = (1 / C(p)) * Σ_{q∈Ω} v(q) * f(p,q)
```

### 📌 가중치 함수 예시
- Gaussian weighting:
```
f(p,q) = exp( - ||B(p) - B(q)||^2 / h^2 )
```
- B(p): 픽셀 p 주변 패치
- h: 필터 파라미터 (유사도 민감도)

## 📊 특징
- 장점:
  - 텍스처와 세부 구조 보존
  - Gaussian/Median 필터보다 선명한 결과
- 단점:
  - 계산량이 많음 (픽셀마다 전체 영상 탐색 → O(N²))
  - 실제 구현에서는 “search window”와 “patch size”를 제한해 속도 개선

## 📌 활용
- 영상 잡음 제거 (특히 Gaussian noise)
- 의료 영상: MRI, CT에서 세부 구조 보존
- 컴퓨터 비전: 텍스처 유지가 중요한 경우
- 라이브러리 지원: OpenCV(cv.fastNlMeansDenoising), scikit-image(denoise_nl_means)

- 👉 정리하면, Non-local Means는 **비슷한 패치를 찾아 평균** 하는 방식으로 잡음을 
  제거하면서도 텍스처를 보존하는 고급 필터링 기법입니다.

---

