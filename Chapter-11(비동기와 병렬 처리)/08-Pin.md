# ğŸ“Œ Pinì´ ì™œ í•„ìš”í•œê°€?
RustëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **ê°’ì„ ììœ ë¡­ê²Œ ì´ë™(move)**ì‹œí‚¬ ìˆ˜ ìˆìŒ.  
í•˜ì§€ë§Œ ì–´ë–¤ íƒ€ì…ì€ ìê¸° ìì‹ ì„ ì°¸ì¡°í•˜ê±°ë‚˜, ë©”ëª¨ë¦¬ ìœ„ì¹˜ê°€ ë°”ë€Œë©´ ì•ˆ ë˜ëŠ” êµ¬ì¡°ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŒ:
```rust
struct SelfRef {
    data: String,
    ptr: *const String,
}
```

ì´ êµ¬ì¡°ëŠ” dataë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°ë¥¼ ë‚´ë¶€ì— ê°€ì§€ê³  ìˆìŒ.  
ê·¸ëŸ°ë° ì´ ê°’ì´ moveë˜ë©´ dataì˜ ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ ë°”ë€Œê³ , ptrì€ dangling pointerê°€ ë˜ì–´ë²„ë¦¼.  
RustëŠ” ì´ëŸ° ê±¸ ì»´íŒŒì¼ íƒ€ì„ì— ë§‰ì„ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, Pinì´ë¼ëŠ” ê°œë…ì„ ë„ì…í•¨.


## ğŸ§  Pinì˜ í•µì‹¬ ê°œë…
- Pin<T>ëŠ” Të¥¼ ê³ ì •ëœ ë©”ëª¨ë¦¬ ìœ„ì¹˜ì— "í•€"ìœ¼ë¡œ ë°•ì•„ë‘” ê²ƒì²˜ëŸ¼ ë§Œë“¤ì–´ì„œ, ì´ë™ ë¶ˆê°€ëŠ¥í•˜ê²Œ ë§Œë“¦
- Pin<&mut T> ë˜ëŠ” Pin<Box<T>> í˜•íƒœë¡œ ì‚¬ìš©
- Unpin íŠ¸ë ˆì‡ì„ êµ¬í˜„í•œ íƒ€ì…ì€ ì´ë™ ê°€ëŠ¥ â†’ Pinì´ í•„ìš” ì—†ìŒ
- Unpinì„ êµ¬í˜„í•˜ì§€ ì•Šì€ íƒ€ì…ì€ Pinì„ í†µí•´ ì´ë™ ê¸ˆì§€ë¥¼ ë³´ì¥í•´ì•¼ í•¨

## ğŸ§ª ì‹¤ì œ ì‚¬ìš© ì˜ˆ: async/await
ë¹„ë™ê¸° í•¨ìˆ˜ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ìê¸° ì°¸ì¡° êµ¬ì¡°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ. ì˜ˆë¥¼ ë“¤ì–´:
```rust
async fn example() {
    // ë‚´ë¶€ì ìœ¼ë¡œ Futureê°€ ìê¸° ìì‹ ì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŒ
}
```


ì´ëŸ° ê²½ìš° RustëŠ” Futureë¥¼ Pin<Box<dyn Future>>ë¡œ ê°ì‹¸ì„œ ë©”ëª¨ë¦¬ ìœ„ì¹˜ê°€ ê³ ì •ë˜ë„ë¡ ê°•ì œí•¨.  
ê·¸ë˜ì•¼ ì•ˆì „í•˜ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ.

## ğŸ” Pinì„ ì‚¬ìš©í•˜ëŠ” ì½”ë“œ ì˜ˆì‹œ
```rust
use std::pin::Pin;
use std::future::Future;

fn poll_future(fut: Pin<&mut dyn Future<Output = ()>>) {
    // ì•ˆì „í•˜ê²Œ Futureë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ
}
```

- `Pin<&mut dyn Future>`ëŠ” Futureê°€ ì´ë™ë˜ì§€ ì•Šë„ë¡ ë³´ì¥
- poll() ê°™ì€ í•¨ìˆ˜ëŠ” ë°˜ë“œì‹œ Pinì„ ìš”êµ¬í•¨

## ğŸ§© Unpinì´ë€?
- ëŒ€ë¶€ë¶„ì˜ íƒ€ì…ì€ Unpinì„ ìë™ìœ¼ë¡œ êµ¬í˜„í•¨ â†’ ììœ ë¡­ê²Œ ì´ë™ ê°€ëŠ¥
- ìê¸° ì°¸ì¡° êµ¬ì¡°ë¥¼ ê°€ì§„ íƒ€ì…ì€ Unpinì„ êµ¬í˜„í•˜ì§€ ì•ŠìŒ â†’ Pinì´ í•„ìš”í•¨
- Unpinì€ â€œì´ íƒ€ì…ì€ ì•ˆì „í•˜ê²Œ ì´ë™í•  ìˆ˜ ìˆë‹¤â€ëŠ” í‘œì‹œì•¼

## âœ… ìš”ì•½: Rustì˜ `Pin`ê³¼ `Unpin`

| ê°œë…     | ì„¤ëª…                                                                 |
|----------|----------------------------------------------------------------------|
| `Pin<T>` | Tì˜ ë©”ëª¨ë¦¬ ìœ„ì¹˜ë¥¼ ê³ ì •ì‹œì¼œ ì´ë™ì„ ë°©ì§€í•¨. ìê¸° ì°¸ì¡° êµ¬ì¡°ë‚˜ asyncì—ì„œ ì‚¬ìš©ë¨. |
| `Unpin`  | íƒ€ì…ì´ ì•ˆì „í•˜ê²Œ ì´ë™ ê°€ëŠ¥í•¨ì„ ë‚˜íƒ€ë‚´ëŠ” íŠ¸ë ˆì‡. ëŒ€ë¶€ë¶„ì˜ íƒ€ì…ì€ ìë™ êµ¬í˜„ë¨. |
| ì‚¬ìš©ì²˜   | Future, Stream, ìê¸° ì°¸ì¡° êµ¬ì¡°ì²´, ë¹„ë™ê¸° ì•ˆì „ì„± í™•ë³´ ë“±                  |
| ëª©ì      | ë©”ëª¨ë¦¬ ì•ˆì „ì„±ê³¼ ë™ì‘ ì•ˆì •ì„±ì„ ì»´íŒŒì¼ íƒ€ì„ì— ë³´ì¥                         |


## ğŸ”š ê²°ë¡ 
Pinì€ Rustì˜ ë©”ëª¨ë¦¬ ì•ˆì „ì„± ì² í•™ì„ ë¹„ë™ê¸°ì™€ ìê¸° ì°¸ì¡° êµ¬ì¡°ê¹Œì§€ í™•ì¥í•˜ê¸° ìœ„í•œ ë„êµ¬. 
ì²˜ìŒì—” ìƒì†Œí•˜ì§€ë§Œ, ì´ê±¸ í†µí•´ RustëŠ” C/C++ì—ì„œë„ ì–´ë ¤ìš´ ë¬¸ì œë¥¼ ì•ˆì „í•˜ê²Œ í•´ê²°í•  ìˆ˜ ìˆìŒ.


## ì‹¤ì „ ì˜ˆì œ
ì•„ë˜ëŠ” Pinì„ ì‚¬ìš©í•˜ëŠ” ì‹¤ì „ ì˜ˆì œ ì „ì²´ ì½”ë“œ.  
asyncì™€ Pinì´ ì‹¤ì œë¡œ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” ê°„ë‹¨í•œ êµ¬ì¡°ë¡œ, Futureë¥¼ ì§ì ‘ êµ¬í˜„í•˜ê³  Pinì„ í†µí•´ ì•ˆì „í•˜ê²Œ ì‹¤í–‰í•˜ëŠ” ì˜ˆì œ.

### ğŸ“¦ ì˜ˆì œ: Pinì„ ì‚¬ìš©í•œ ì»¤ìŠ¤í…€ Future ì‹¤í–‰
```rust
use std::pin::Pin;
use std::task::{Context, Poll};
use std::future::Future;
use std::time::Duration;
use std::thread;
use std::sync::{Arc, Mutex};
use std::task::Waker;

// ì»¤ìŠ¤í…€ Future êµ¬ì¡°ì²´
struct MyFuture {
    shared_state: Arc<Mutex<bool>>,
}

impl Future for MyFuture {
    type Output = &'static str;

    fn poll(self: Pin<&mut Self>, cx: &mut Context<'_>) -> Poll<Self::Output> {
        let mut state = self.shared_state.lock().unwrap();
        if *state {
            Poll::Ready("ì™„ë£Œ!")
        } else {
            println!("ì•„ì§ ì¤€ë¹„ ì•ˆ ë¨, waker ì €ì¥");
            let waker = cx.waker().clone();
            let shared = self.shared_state.clone();
            thread::spawn(move || {
                thread::sleep(Duration::from_secs(2));
                let mut state = shared.lock().unwrap();
                *state = true;
                waker.wake();
            });
            Poll::Pending
        }
    }
}

fn main() {
    use futures::executor::block_on;

    let shared_state = Arc::new(Mutex::new(false));
    let future = MyFuture { shared_state };

    // Pinìœ¼ë¡œ Futureë¥¼ ê³ ì •
    let pinned_future = Box::pin(future);

    // ì‹¤í–‰
    let result = block_on(pinned_future);
    println!("ê²°ê³¼: {}", result);
}

```

## ğŸ” í•µì‹¬ í¬ì¸íŠ¸
- MyFutureëŠ” Future íŠ¸ë ˆì‡ì„ ì§ì ‘ êµ¬í˜„í•¨
- poll() ë©”ì„œë“œëŠ” Pin<&mut Self>ë¥¼ ë°›ìŒ â†’ ì´ë™ ê¸ˆì§€ ë³´ì¥
- block_on()ì€ futures í¬ë ˆì´íŠ¸ì˜ ì‹¤í–‰ê¸°
- Pin<Box<T>>ë¥¼ í†µí•´ Futureë¥¼ ì•ˆì „í•˜ê²Œ ê³ ì •í•˜ê³  ì‹¤í–‰

## ğŸ§  ì™œ Pinì´ í•„ìš”í•œê°€?
- poll()ì€ Future ë‚´ë¶€ ìƒíƒœë¥¼ ì°¸ì¡°í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŒ
- Futureê°€ ìê¸° ìì‹ ì„ ì°¸ì¡°í•˜ê±°ë‚˜, ë‚´ë¶€ì—ì„œ ë¹„ë™ê¸° íë¦„ì„ ë§Œë“¤ ê²½ìš° ì´ë™ë˜ë©´ ìœ„í—˜í•¨
- Pinì€ ê·¸ëŸ° Futureë¥¼ ê³ ì •ëœ ìœ„ì¹˜ì—ì„œ ì•ˆì „í•˜ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•´ì¤Œ
