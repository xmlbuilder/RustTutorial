# include!
Rust의 include! 매크로와 함께 concat!, env!를 사용하는 방식으로 외부 파일의 내용을 컴파일 타임에 코드로 삽입하는 구조. 
아래에 이 코드가 어떻게 동작하는지 단계별로 설명.

## 🔍 코드 분석
```rust
const CUBE_TABLES: [[i32;16];256] = include!(concat!(env!("CARGO_MANIFEST_DIR"), "/tables/mc_tri_table.incl.rs"));
```

### 1. env!("CARGO_MANIFEST_DIR")
- 이 매크로는 현재 프로젝트의 루트 디렉토리 경로를 문자열로 반환해요.
- 예: /home/junghwan/my_project
### 2. concat!(...)
- 문자열을 컴파일 타임에 연결해줍니다.
- 결과: "/home/junghwan/my_project/tables/mc_tri_table.incl.rs"
### 3. include!(...)
- 해당 경로의 파일 내용을 그대로 현재 위치에 코드로 삽입합니다.
- 즉, mc_tri_table.incl.rs 파일의 내용이 include! 위치에 복사된 것처럼 처리됨

### 📦 mc_tri_table.incl.rs 내용 예시
```
[
    [ -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1 ],
    // ... 총 256개의 배열
]
```

- 이 파일은 [[i32; 16]; 256] 타입의 데이터를 정의한 정적 테이블
- 보통 마칭 큐브(Marching Cubes) 알고리즘에서 삼각형 인덱스를 저장하는 데 사용됨

## 🧠 전체 동작 흐름
- 컴파일 타임에 env!("CARGO_MANIFEST_DIR")로 프로젝트 루트 경로를 가져옴
- concat!으로 파일 경로를 완성
- include!로 해당 파일의 내용을 현재 코드에 삽입
- CUBE_TABLES는 [[i32; 16]; 256] 타입의 상수로 초기화됨

## ✅ 왜 이렇게 쓰는가?
| 목적                     | 설명                                                                 |
|--------------------------|----------------------------------------------------------------------|
| 대용량 데이터 분리        | 코드와 테이블 데이터를 분리하여 가독성과 유지보수를 향상시킴             |
| 컴파일 타임 포함          | 런타임 로딩이 아닌 컴파일 타임에 코드로 포함되어 성능과 안정성 확보       |
| 경로 유연성 확보          | `env!`, `concat!`을 통해 경로를 동적으로 구성하여 다양한 환경에서 유연하게 대응 |
| 코드 재사용 및 모듈화     | 테이블이나 설정 파일을 여러 모듈에서 재사용 가능                         |


---

## 📦 Rust의 include 계열 매크로 비교
| 매크로            | 설명                                       | 반환 타입         | 주요 용도                         | 특징                                  |
|-------------------|--------------------------------------------|-------------------|-----------------------------------|----------------------------------------|
| `include!`        | 외부 Rust 코드 파일을 현재 위치에 삽입       | 코드 조각          | 정적 테이블, 자동 생성된 코드 등   | 컴파일 타임에 코드로 해석됨            |
| `include_str!`    | 파일 내용을 문자열로 포함                   | `&'static str`     | 설정 파일, HTML, Markdown 등       | 줄바꿈 포함, 텍스트 그대로 삽입         |
| `include_bytes!`  | 파일 내용을 바이트 배열로 포함               | `&'static [u8]`    | 이미지, 바이너리, 폰트 등 리소스   | 바이너리 그대로 삽입, 디코딩 필요할 수 있음 |


## 🔍 예시 코드
### 1. include!
```rust
const TABLE: [[i32; 16]; 256] = include!("mc_tri_table.incl.rs");
```

- mc_tri_table.incl.rs는 Rust 코드 형식의 배열을 정의한 파일
- 컴파일 타임에 코드로 삽입됨

### 2. include_str!
```rust
const HTML: &str = include_str!("template.html");
```
- template.html의 내용을 문자열로 읽어옴
- HTML, Markdown, JSON 등 텍스트 기반 파일에 적합

### 3. include_bytes!
```rust
const LOGO: &[u8] = include_bytes!("logo.png");
```

- logo.png의 내용을 바이트 배열로 읽어옴
- 이미지, 오디오, 바이너리 리소스 등에 적합

## ✅ 언제 쓰면 좋을까?
| 상황 또는 목적             | 추천 매크로         |
|----------------------------|----------------------|
| 외부 Rust 코드 삽입         | `include!`           |
| 텍스트 파일을 문자열로 읽기 | `include_str!`       |
| 바이너리 파일을 바이트로 읽기| `include_bytes!`     |


## 🧠 보너스 팁
- 세 매크로 모두 컴파일 타임에 포함되므로 런타임 I/O가 필요 없음
- 파일 경로는 상대 경로 또는 concat!(env!(...))로 동적 구성 가능
- include_str!과 include_bytes!는 파일 내용을 그대로 포함하지만, include!는 코드로 해석됨

## ✅ 같은 디렉토리에서 include! 사용하는 방법
### 📁 예시 디렉토리 구조
```
src/
├── main.rs
├── table.rs
├── mc_tri_table.incl.rs
```

## 🔧 main.rs 또는 table.rs에서 사용
```rust
const CUBE_TABLES: [[i32; 16]; 256] = include!("mc_tri_table.incl.rs");
```

- include!("mc_tri_table.incl.rs")는 현재 파일과 같은 디렉토리에 있는 파일을 삽입
- 경로는 현재 파일 기준의 상대 경로로 해석됨

## 🧠 주의사항
| 항목             | 설명                                                                 |
|------------------|----------------------------------------------------------------------|
| 경로 기준         | `include!`는 **현재 소스 파일 기준**으로 경로를 해석함 (`src/main.rs` 기준이면 `src/` 기준) |
| 파일 확장자       | `.rs`, `.incl.rs`, `.txt` 등 확장자 제한 없음 (Rust 코드 형식이면 됨)         |
| 삽입 위치         | `include!`는 **정확히 Rust 코드가 필요한 위치**에 삽입해야 컴파일 오류 없음     |
| 매크로 중첩 주의  | `include!` 안에 또 다른 `include!`가 있을 경우 경로 충돌이나 오류 발생 가능       |


## 💡 팁: 디렉토리 경로가 복잡할 경우
```rust
include!(concat!(env!("CARGO_MANIFEST_DIR"), "/src/mc_tri_table.incl.rs"));
```
- env!("CARGO_MANIFEST_DIR")는 프로젝트 루트 경로
- concat!으로 절대 경로처럼 구성 가능
- 빌드 스크립트나 외부 생성 파일을 포함할 때 유용

## 🧩 요약
| 상황 또는 목적                         | 추천 방식                                           |
|----------------------------------------|----------------------------------------------------|
| 같은 디렉토리의 파일 포함               | `include!("filename.rs")`                          |
| 상위 또는 다른 디렉토리의 파일 포함     | `include!("../path/to/file.rs")`                   |
| 프로젝트 루트 기준으로 절대 경로 구성   | `include!(concat!(env!("CARGO_MANIFEST_DIR"), "..."))` |


