## on_arc_half_angle
- ì´ í•¨ìˆ˜ëŠ” **ì› ì¤‘ì‹¬ Oì—ì„œ ë‘ ì  A, Bë¡œ í–¥í•˜ëŠ” ë°˜ì§€ë¦„ ë²¡í„°ê°€ ì´ë£¨ëŠ” ê°ë„ì˜ ì ˆë°˜(halfâ€‘angle)**  
    ì„ ê³„ì‚°í•˜ëŠ” ë§¤ìš° ê¹”ë”í•œ ê¸°í•˜ ì•Œê³ ë¦¬ì¦˜.
- ì›í˜¸(arc) ê³„ì‚°, ì›í˜¸ ë³´ê°„, tangent/normal ê³„ì‚° ë“±ì—ì„œ ìì£¼ ë“±ì¥í•˜ëŠ” í•µì‹¬ ê³µì‹.
ì•„ë˜ëŠ” ë¬¸ì„œì— ê·¸ëŒ€ë¡œ ë„£ì„ ìˆ˜ ìˆëŠ” ì™„ì „í•œ ìˆ˜í•™ì  ì„¤ëª… + ê¸°í•˜í•™ì  ì˜ë¯¸ë¥¼ ì •ë¦¬í•œ ë²„ì „ì´ë‹¤.

### ğŸ“˜ on_arc_half_angle(o, a, b)
- ì¤‘ì‹¬ Oì—ì„œ ì  A, Bë¡œ í–¥í•˜ëŠ” ë‘ ë²¡í„°ì˜ ê°ë„ ì ˆë°˜ì„ ë°˜í™˜

### 1ï¸âƒ£ ë²¡í„° ì •ì˜
```rust
ux = a.x - o.x
uy = a.y - o.y
vx = b.x - o.x
vy = b.y - o.y
```

- ì¦‰:
```math
\mathbf{u}=A-O,\quad \mathbf{v}=B-O
```
###  2ï¸âƒ£ ë²¡í„° ê¸¸ì´ ê³„ì‚° ë° degenerate ê²€ì‚¬
```rust
nu = |u|
nv = |v|
if !(nu > 0 && nv > 0) return 0
```
- ë‘ ë²¡í„° ì¤‘ í•˜ë‚˜ë¼ë„ ê¸¸ì´ê°€ 0ì´ë©´ ê°ë„ë¥¼ ì •ì˜í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ 0 ë°˜í™˜.

### 3ï¸âƒ£ ë‘ ë²¡í„°ì˜ ì½”ì‚¬ì¸(cos Î¸) ê³„ì‚°
```rust
c = (ux*vx + uy*vy) / (nu * nv)
```

- ìˆ˜ì‹:
```math
c=\frac{\mathbf{u}\cdot \mathbf{v}}{\| \mathbf{u}\| \| \mathbf{v}\| }=\cos \theta 
```
### 4ï¸âƒ£ ìˆ˜ì¹˜ ì•ˆì •í™”ë¥¼ ìœ„í•œ clamp
```rust
if c < -1 { c = -1 }
if c > 1 { c = 1 }
```

- ë¶€ë™ì†Œìˆ˜ì  ì˜¤ì°¨ë¡œ ì¸í•´
$\cos \theta ê°€ Â±1.000000002$ ê°™ì€ ê°’ì´ ë˜ëŠ” ê²ƒì„ ë°©ì§€.

### 5ï¸âƒ£ ê°ë„ì˜ ì ˆë°˜ ë°˜í™˜
```rust
0.5 * c.acos()
```

- ì¦‰:
```math
\frac{\theta }{2}=\frac{1}{2}\arccos (c)
```

### ğŸ“Œ ìµœì¢… ìš”ì•½

- Oë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•˜ëŠ” ë‘ ë°˜ì§€ë¦„ ë²¡í„°ì˜ ê°ë„ Î¸ë¥¼ êµ¬í•˜ê³   
    ê·¸ ì ˆë°˜ì¸ Î¸/2ë¥¼ ë°˜í™˜í•œë‹¤.

### ğŸ“Œ ê¸°í•˜í•™ì  ì˜ë¯¸
- ì´ í•¨ìˆ˜ëŠ” ë‹¤ìŒ ìƒí™©ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤:
    - ì›í˜¸(arc) ë³´ê°„ ì‹œ tangent ë°©í–¥ ê³„ì‚°
    - ì›í˜¸ ê¸¸ì´/ì„¸ê·¸ë¨¼íŠ¸ ë¶„í• 
    - ì›í˜¸ ê¸°ë°˜ ìŠ¤ìœ•(sweep) ê³„ì‚°
    - ì›í˜¸ì˜ chordâ€‘angle ê´€ê³„
    - ì›í˜¸ì˜ ì¤‘ì‹¬ê°(center angle) ê³„ì‚°ì˜ ì¼ë¶€
- íŠ¹íˆ acos + clamp + half-angle ì¡°í•©ì€  
    CAD ì—”ì§„ì—ì„œ ì›í˜¸ë¥¼ ë‹¤ë£° ë•Œ ê±°ì˜ í‘œì¤€ íŒ¨í„´ì´ë‹¤.


```rust
#[inline]
pub fn on_arc_half_angle(o: &Point2D, a: &Point2D, b: &Point2D) -> f64 {
    let ux = a.x - o.x;
    let uy = a.y - o.y;
    let vx = b.x - o.x;
    let vy = b.y - o.y;

    let nu = (ux * ux + uy * uy).sqrt();
    let nv = (vx * vx + vy * vy).sqrt();
    if !(nu > 0.0 && nv > 0.0) {
        return 0.0;
    }

    let mut c = (ux * vx + uy * vy) / (nu * nv);
    if c < -1.0 {
        c = -1.0;
    }
    if c > 1.0 {
        c = 1.0;
    }

    0.5 * c.acos()
}
```
## on_are_equal_param

- CADÂ·Geometry ì—”ì§„ì—ì„œ ìì£¼ ë“±ì¥í•˜ëŠ” **íŒŒë¼ë¯¸í„° ë¹„êµ(parameter equality)**  
    ë¥¼ ìœ„í•œ ì•ˆì •ì ì¸ ìœ í‹¸ë¦¬í‹°ê³ , íŠ¹íˆ ë¬´í•œëŒ€(Â±âˆ) ì²˜ë¦¬ê°€ ë“¤ì–´ê°„ ì ì´ í•µì‹¬.

### ğŸ“˜ on_are_equal_param(a, b, tol)
- íŒŒë¼ë¯¸í„° a, bê°€ ìˆ˜ì¹˜ì ìœ¼ë¡œ ê°™ì€ì§€ íŒì • (âˆ í¬í•¨)
- ì´ í•¨ìˆ˜ëŠ” ë‹¤ìŒ ê·œì¹™ì— ë”°ë¼ ë‘ ì‹¤ìˆ˜ íŒŒë¼ë¯¸í„°ê°€ â€œê°™ë‹¤â€ê³  íŒë‹¨í•œë‹¤:

### 1ï¸âƒ£ ìœ í•œì„± ê²€ì‚¬ (finite check)
```rust
let fa = a.is_finite();
let fb = b.is_finite();
```

- fa == false â†’ aëŠ” NaN ë˜ëŠ” Â±âˆ
- fb == false â†’ bëŠ” NaN ë˜ëŠ” Â±âˆ

### 2ï¸âƒ£ ë‘˜ ë‹¤ ìœ í•œí•˜ì§€ ì•Šìœ¼ë©´ â†’ equal
```rust
if !fa && !fb {
    return true;
}
```

- ì¦‰:
```math
a,b\notin \mathbb{R}\quad \Rightarrow \quad \mathrm{equal}
```
- ì—¬ê¸°ì„œ â€œìœ í•œí•˜ì§€ ì•ŠìŒâ€ì€ ë‹¤ìŒì„ í¬í•¨:
    - a = +âˆ, b = +âˆ
    - a = -âˆ, b = -âˆ
    - a = NaN, b = NaN
- CAD ì—”ì§„ì—ì„œ íŒŒë¼ë¯¸í„°ê°€ ë¬´í•œëŒ€ë¡œ ë»—ëŠ” ê²½ìš°(ì˜ˆ: ë¬´í•œ ì§ì„ )
- ë‘ ê°’ì´ ëª¨ë‘ finiteê°€ ì•„ë‹ˆë©´ â€œê°™ë‹¤â€ë¡œ ì·¨ê¸‰í•˜ëŠ” íŒ¨í„´ì´ ì¢…ì¢… ì‚¬ìš©ëœë‹¤.

### 3ï¸âƒ£ ë‘˜ ë‹¤ ìœ í•œí•˜ë©´ â†’ ì ˆëŒ€ ì˜¤ì°¨ ë¹„êµ
```rust
if fa && fb {
    return (a - b).abs() <= tol;
}
```

- ì¦‰:
```math
|a-b|\leq \mathrm{tol}
```
- 4ï¸âƒ£ í•œìª½ë§Œ ìœ í•œí•˜ë©´ â†’ equal ì•„ë‹˜
```rust
false
```

- ì¦‰:
    - a = finite, b = infinite â†’ false
    - a = infinite, b = finite â†’ false
    - a = NaN, b = finite â†’ false
    - a = finite, b = NaN â†’ false


### ğŸ“Œ ê¸°í•˜í•™ì  ì˜ë¯¸
- ì´ í•¨ìˆ˜ëŠ” ë‹¤ìŒ ìƒí™©ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤:
    - ê³¡ì„ /ê³¡ë©´ íŒŒë¼ë¯¸í„° ë¹„êµ
        - (ì˜ˆ: t = Â±âˆ ë¡œ í™•ì¥ëœ ì„ ë¶„/ì§ì„ )
    - ë„ë©”ì¸ ë°– íŒŒë¼ë¯¸í„° ì²˜ë¦¬
    - ë¬´í•œëŒ€ íŒŒë¼ë¯¸í„°ë¥¼ ê°–ëŠ” ê¸°í•˜ ê°ì²´ ë¹„êµ
    - ìˆ˜ì¹˜ì  ì•ˆì •ì„± í™•ë³´
- íŠ¹íˆ CAD ì—”ì§„ì—ì„œëŠ” **ë‘˜ ë‹¤ ìœ í•œí•˜ì§€ ì•Šìœ¼ë©´ equal** ì´ë¼ëŠ” ê·œì¹™ì´  
    ì§ì„ , ë ˆì´(ray), ë¬´í•œ ê³¡ì„  ë“±ì—ì„œ ë§¤ìš° ìœ ìš©í•˜ë‹¤.


```rust
pub fn on_are_equal_param(a: f64, b: f64, tol: f64) -> bool {
    let fa = a.is_finite();
    let fb = b.is_finite();
    if !fa && !fb {
        return true;
    }
    if fa && fb {
        return (a - b).abs() <= tol;
    }
    false
}
```

## on_linspace
- í•¨ìˆ˜ëŠ” êµ¬ê°„ [a, b]ë¥¼ nê°œì˜ ê· ì¼í•œ ì ìœ¼ë¡œ ë¶„í• í•˜ëŠ” linspace ìƒì„±ê¸°ë¡œ,  
    ìˆ˜ì¹˜í•´ì„Â·CADÂ·ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ì •ë§ ìì£¼ ì“°ì´ëŠ” ê¸°ë³¸ ìœ í‹¸ë¦¬í‹°.
- MATLABì˜ linspace, Python NumPyì˜ np.linspaceì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰.

### ğŸ“˜ on_linspace(a, b, n)
- êµ¬ê°„ [a, b]ë¥¼ nê°œì˜ ê· ì¼í•œ ì ìœ¼ë¡œ ìƒì„±

### 1ï¸âƒ£ n ë³´ì •
```rust
let n = n.max(1);
if n == 1 {
    return vec![a];
}
```

- nì´ 1 ì´í•˜ë¡œ ë“¤ì–´ì˜¤ë©´ ìµœì†Œ 1ë¡œ ë³´ì •
- n = 1ì´ë©´ ë‹¨ì¼ ê°’ [a]ë§Œ ë°˜í™˜
    - (MATLAB linspace(a,b,1)ê³¼ ë™ì¼í•œ ë™ì‘)

### 2ï¸âƒ£ ê°„ê²© h ê³„ì‚°
```rust
let h = (b - a) / ((n - 1) as f64);
```

- ìˆ˜ì‹:
```math
h=\frac{b-a}{n-1}
```
- ì¦‰, nê°œì˜ ì ì´ aì™€ bë¥¼ í¬í•¨í•˜ì—¬ ê· ì¼í•˜ê²Œ ë¶„í¬í•˜ë„ë¡ ê°„ê²©ì„ ê³„ì‚°í•œë‹¤.

### 3ï¸âƒ£ ì  ìƒì„±
```rust
(0..n).map(|i| a + h * (i as f64)).collect()
```

- ì¦‰:
```math
x_i=a+ih,\quad i=0,1,\dots ,n-1
```
- ê²°ê³¼:
```math
[a,\; a+h,\; a+2h,\; \dots ,\; b]
```
### ğŸ“Œ ìµœì¢… ìš”ì•½
- íŠ¹ì§•:
    - aì™€ bë¥¼ í•­ìƒ í¬í•¨
    - n=1ì¼ ë•ŒëŠ” [a]
    - ê· ì¼ ë¶„í• (uniform sampling)

### ğŸ“Œ ê¸°í•˜í•™ì /ìˆ˜ì¹˜ì  í™œìš©
- ê³¡ì„ /ê³¡ë©´ íŒŒë¼ë¯¸í„° ë¶„í• 
- ì ë¶„/ë³´ê°„/ìƒ˜í”Œë§
- ê·¸ë˜í”„ ê·¸ë¦¬ê¸°ìš© xì¶• ìƒì„±
- CADì—ì„œ ë“±ë¶„ì  ìƒì„±
- ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ì‹œê°„ ìŠ¤í… ìƒì„±
- ì¦‰, ìˆ˜ì¹˜ ê³„ì‚°ì—ì„œ ê°€ì¥ ê¸°ë³¸ì ì´ë©´ì„œë„ í•„ìˆ˜ì ì¸ ê· ì¼ ìƒ˜í”Œë§ í•¨ìˆ˜ì•¼.

```rust
pub fn on_linspace(a: f64, b: f64, n: i32) -> Vec<f64> {
    let n = n.max(1);
    if n == 1 {
        return vec![a];
    }
    let h = (b - a) / ((n - 1) as f64);
    (0..n).map(|i| a + h * (i as f64)).collect()
}
```
## on_angle_2pi_normalize

- 2Ï€ ì£¼ê¸°(angle modulo) ì •ê·œí™”ëŠ” CADÂ·GeometryÂ·RoboticsÂ·Simulationì—ì„œ  
    ì•„ì£¼ ìì£¼ ë“±ì¥í•˜ëŠ” í•µì‹¬ ìœ í‹¸ë¦¬í‹°, 
- ì´ êµ¬í˜„ì€ ìˆ˜ì¹˜ ì•ˆì •ì„± + ê°„ê²°í•¨ì„ ëª¨ë‘ ê°–ì¶˜ í‘œì¤€ì ì¸ í˜•íƒœ.

### ğŸ“˜ on_angle_2pi_normalize(a)
- ê°ë„ a(ë¼ë””ì•ˆ)ë¥¼ 0, 2Ï€) ë²”ìœ„ë¡œ ì •ê·œí™”(normalize)

### 1ï¸âƒ£ ìœ í•œì„± ê²€ì‚¬
```rust
if !a.is_finite() {
    return f64::NAN;
}
```
- ì…ë ¥ì´ NaN, +âˆ, -âˆì´ë©´ ì •ìƒì ì¸ ê°ë„ë¡œ í•´ì„í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ NaN ë°˜í™˜
- CAD/Geometry ì—”ì§„ì—ì„œ ë§¤ìš° ì¤‘ìš”í•œ ì•ˆì •ì„± ì²˜ë¦¬

### 2ï¸âƒ£ 2Ï€ ëª¨ë“ˆë¡œ(modulo) ì—°ì‚°
```rust
let mut r = a % TAU;
```

- ìˆ˜ì‹:
- Rustì˜ %ëŠ” ìˆ˜í•™ì  modê°€ ì•„ë‹ˆë¼ remainderì´ë¯€ë¡œ ìŒìˆ˜ ì…ë ¥ ì‹œ  
`ìŒìˆ˜ remainderê°€ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤.

### 3ï¸âƒ£ ìŒìˆ˜ ë³´ì • â†’ 0, 2Ï€) ë²”ìœ„ë¡œ ì´ë™
```rust
if r < 0.0 {
    r += TAU;
}
```

- ì¦‰:
```math
r<0\Rightarrow r=r+2\pi
``` 
- ì´ ê³¼ì •ì„ í†µí•´ ìµœì¢… ê²°ê³¼ëŠ” í•­ìƒ:
```math
0\leq r<2\pi 
```
### ğŸ“Œ ìµœì¢… ìš”ì•½

- ì¦‰, ê°ë„ë¥¼ 0 ì´ìƒ 2Ï€ ë¯¸ë§Œì˜ í‘œì¤€ ë²”ìœ„ë¡œ ì •ê·œí™”í•˜ëŠ” í•¨ìˆ˜ë‹¤.

### ğŸ“Œ ê¸°í•˜í•™ì  ì˜ë¯¸
- ì´ í•¨ìˆ˜ëŠ” ë‹¤ìŒ ìƒí™©ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤:
    - íšŒì „ ê°ë„ ì •ê·œí™”
    - ì›í˜¸(arc) ê³„ì‚°
    - ë¡œë´‡ ê´€ì ˆ ê°ë„ wrapping
    - ë°©í–¥(angle heading) ê³„ì‚°
    - ì‚¼ê°í•¨ìˆ˜ ê¸°ë°˜ ì•Œê³ ë¦¬ì¦˜ ì•ˆì •í™”
    - ê°ë„ ë¹„êµ ì‹œ wrap-around ë¬¸ì œ ë°©ì§€
- ì˜ˆë¥¼ ë“¤ì–´,
    - -0.1 rad â†’ `2Ï€ - 0.1`
    - 7.0 rad â†’ `7.0 - 2Ï€`
    - 15Ï€ â†’ `15Ï€ mod 2Ï€` = `Ï€`

```rust
#[inline]
pub fn on_angle_2pi_normalize(a: f64) -> f64 {
    if !a.is_finite() {
        return f64::NAN;
    }
    let mut r = a % TAU;
    if r < 0.0 {
        r += TAU;
    }
    r
}
```

```rust
#[inline]
pub fn on_normalize_to_domain(dom: &Interval, t01: f64) -> f64 {
    dom.parameter_at(t01.clamp(0.0, 1.0))
}
```
## on_modify_param_diff

- ì´ í•¨ìˆ˜ëŠ” **ì£¼ê¸°ì  íŒŒë¼ë¯¸í„° ê³µê°„(periodic parameter domain)**ì—ì„œ  
    ë‘ íŒŒë¼ë¯¸í„° a,bì˜ ì°¨ì´ë¥¼ **ê°€ì¥ ì§§ì€ ë°©í–¥(shortest wrapped difference)**  
    ìœ¼ë¡œ ì¡°ì •í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜.

- NURBS, ì›í˜¸, ì£¼ê¸°ì  ê³¡ì„ /ê³¡ë©´, ê°ë„ ê³„ì‚° ë“±ì—ì„œ ë§¤ìš° ìì£¼ ì“°ì´ëŠ” í•µì‹¬ ìœ í‹¸ë¦¬í‹°.

### ğŸ“˜ on_modify_param_diff(a, b, dom)
- ì£¼ê¸°ì  ë„ë©”ì¸ì—ì„œ íŒŒë¼ë¯¸í„° ì°¨ì´(a âˆ’ b)ë¥¼ ê°€ì¥ ì§§ì€ ë°©í–¥ìœ¼ë¡œ ë³´ì •

### 1ï¸âƒ£ ê¸°ë³¸ ê°œë…
- ë„ë©”ì¸ domì€ ê¸¸ì´ lì„ ê°€ì§„ ì£¼ê¸°ì  êµ¬ê°„ì´ë¼ê³  ê°€ì •í•œë‹¤.
- ì˜ˆ:
    - ê°ë„ ë„ë©”ì¸: $[0,2\pi )$ â†’ $l=2\pi$ 
    - ì›í˜¸ íŒŒë¼ë¯¸í„°: $[0,1)$ â†’ $l=1$
    - ì£¼ê¸°ì  NURBS ê³¡ì„ ì˜ íŒŒë¼ë¯¸í„° êµ¬ê°„
- ì´ëŸ° ë„ë©”ì¸ì—ì„œëŠ” ë‘ íŒŒë¼ë¯¸í„°ì˜ ì°¨ì´ a-bëŠ” ì§ì ‘ ë¹¼ë©´ ì˜ëª»ëœ ë°©í–¥ì´ ë  ìˆ˜ ìˆë‹¤.
- ì˜ˆ:
    - ë„ë©”ì¸ ê¸¸ì´ $l=360\degree$ ì¼ ë•Œ
    - $a=350\degree , b=10\degree$
    - ë‹¨ìˆœ ì°¨ì´: $350-10=340\degree$  í•˜ì§€ë§Œ ì‹¤ì œ ìµœë‹¨ ì°¨ì´ëŠ” $âˆ’20Â°$ ì´ë‹¤.
- ì´ í•¨ìˆ˜ëŠ” ë°”ë¡œ ê·¸ ìµœë‹¨ wrap-around ì°¨ì´ë¥¼ ê³„ì‚°í•œë‹¤.

### 2ï¸âƒ£ ì½”ë“œ í•´ì„¤
```rust
let l = dom.length();
let mut d = a - b;
```

- ê¸°ë³¸ ì°¨ì´:
```rust
d=a-b
```

- âœ” wrap-around ë³´ì •
```rust
while d > 0.5 * l {
    d -= l;
}
while d < -0.5 * l {
    d += l;
}
```

- ìˆ˜ì‹ìœ¼ë¡œ í‘œí˜„í•˜ë©´:
```math
d\in \left[ -\frac{l}{2},\frac{l}{2}\right]
``` 
- ì´ êµ¬ê°„ ì•ˆì— ë“¤ì–´ì˜¬ ë•Œê¹Œì§€ ë„ë©”ì¸ ê¸¸ì´ lì„ ë”í•˜ê±°ë‚˜ ë¹¼ì„œ ì¡°ì •í•œë‹¤.
- ì¦‰:
    - dê°€ ë„ˆë¬´ í¬ë©´ â†’ d-l
    - dê°€ ë„ˆë¬´ ì‘ìœ¼ë©´ â†’ d+l
- ì´ ê³¼ì •ì„ í†µí•´ **ìµœë‹¨ ê±°ë¦¬ ì°¨ì´(shortest periodic difference)**ê°€ ëœë‹¤.

### 3ï¸âƒ£ ìµœì¢… ë°˜í™˜ê°’
```
d
```

- ì¦‰, ì£¼ê¸°ì  ë„ë©”ì¸ì—ì„œì˜ ìµœë‹¨ íŒŒë¼ë¯¸í„° ì°¨ì´.

### ğŸ“Œ ìµœì¢… ìš”ì•½

- ì´ í•¨ìˆ˜ëŠ”:
    - íŒŒë¼ë¯¸í„°ê°€ ì£¼ê¸°ì ì¼ ë•Œ
    - ë‘ ê°’ì˜ ì°¨ì´ë¥¼ ê°€ì¥ ì§§ì€ ë°©í–¥ìœ¼ë¡œ ë³´ì •í•´ì¤€ë‹¤.

### ğŸ“Œ ê¸°í•˜í•™ì  ì˜ë¯¸
- ì´ í•¨ìˆ˜ëŠ” ë‹¤ìŒ ìƒí™©ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤:
    - ì›í˜¸(arc) íŒŒë¼ë¯¸í„° ì°¨ì´ ê³„ì‚°
    - ì£¼ê¸°ì  NURBS ê³¡ì„ /ê³¡ë©´ì˜ íŒŒë¼ë¯¸í„° ë¹„êµ
    - ê°ë„ ì°¨ì´ ê³„ì‚° (angle wrapping)
    - íšŒì „/ë°©í–¥ ë¹„êµ
    - ë„ë©”ì¸ wrap-around ë¬¸ì œ ë°©ì§€
- ì˜ˆë¥¼ ë“¤ì–´,
- ê°ë„ ë„ë©”ì¸ $l=2\pi$ ì¼ ë•Œ:
    - $a=350\degree , b=10\degree$  â†’ ê²°ê³¼ = $âˆ’20Â°$
    - $a=5\degree , b=355\degree$  â†’ ê²°ê³¼ = $+10Â°$
- ì¦‰, í•­ìƒ ê°€ì¥ ì§§ì€ ë°©í–¥ì˜ ì°¨ì´ë¥¼ ë°˜í™˜í•œë‹¤.


```rust
pub fn on_modify_param_diff(a: f64, b: f64, dom: &Interval) -> f64 {
    let l = dom.length();
    let mut d = a - b;
    if l > 0.0 {
        while d > 0.5 * l {
            d -= l;
        }
        while d < -0.5 * l {
            d += l;
        }
    }
    d
}
```

## on_angle_2pi_difference

- ì´ í•¨ìˆ˜ëŠ” **ë‘ ê°ë„ a, bì˜ ì°¨ì´ë¥¼ 2Ï€ ì£¼ê¸°ì—ì„œ ê°€ì¥ ì§§ì€ ë°©í–¥(shortest angular difference)**  
    ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ” ì•„ì£¼ ì •ì„ì ì¸ ì•Œê³ ë¦¬ì¦˜.
- ê°ë„ wrap-around ë¬¸ì œë¥¼ ì™„ë²½í•˜ê²Œ ì²˜ë¦¬í•˜ê³  ìˆê³ , ìˆ˜ì¹˜ ì•ˆì •ì„±ê¹Œì§€ ê°–ì¶˜ í˜•íƒœë¼  
    CADÂ·GeometryÂ·Roboticsì—ì„œ ê·¸ëŒ€ë¡œ ì“°ê¸° ì¢‹ì€ ìˆ˜ì¤€.

### ğŸ“˜ on_angle_2pi_difference(a, b)
- ë‘ ê°ë„ a, bì˜ ì°¨ì´ë¥¼ $[-Ï€, Ï€]$ ë²”ìœ„ë¡œ ì •ê·œí™”í•œ ê°’ ë°˜í™˜

### 1ï¸âƒ£ ìœ í•œì„± ê²€ì‚¬
```rust
if !a.is_finite() || !b.is_finite() {
    return f64::NAN;
}
```
- ì…ë ¥ì´ NaN, +âˆ, -âˆì´ë©´ ì •ìƒì ì¸ ê°ë„ ì°¨ì´ë¥¼ ì •ì˜í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ NaN ë°˜í™˜
- ê°ë„ ì—°ì‚°ì—ì„œ ë§¤ìš° ì¤‘ìš”í•œ ì•ˆì •ì„± ì²˜ë¦¬

### 2ï¸âƒ£ ê¸°ë³¸ ì°¨ì´ ê³„ì‚° + 2Ï€ ëª¨ë“ˆë¡œ
```rust
let mut d = (a - b) % TAU;
```

- ìˆ˜ì‹:

- Rustì˜ %ëŠ” remainderì´ë¯€ë¡œ ìŒìˆ˜ remainderê°€ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤.

### 3ï¸âƒ£ wrap-around ë³´ì • â†’ [-Ï€, Ï€] ë²”ìœ„ë¡œ ì´ë™
```rust
if d > PI {
    d -= TAU;
}
if d < -PI {
    d += TAU;
}
```

- ì¦‰:
```math
d\in [-\pi ,\pi ]
```
- ì´ êµ¬ê°„ ì•ˆì— ë“¤ì–´ì˜¬ ë•Œê¹Œì§€ 2Ï€ë¥¼ ë”í•˜ê±°ë‚˜ ë¹¼ì„œ ì¡°ì •í•œë‹¤.
- ì´ ê³¼ì •ì´ ë°”ë¡œ **ìµœë‹¨ ê°ë„ ì°¨ì´(shortest angular difference)**ë¥¼ ë§Œë“œëŠ” í•µì‹¬.

### ğŸ“Œ ìµœì¢… ìš”ì•½

- ì¦‰, ë‘ ê°ë„ì˜ ì°¨ì´ë¥¼ ê°€ì¥ ì§§ì€ ë°©í–¥ìœ¼ë¡œ ì •ê·œí™”í•œ ê°’ì„ ë°˜í™˜í•œë‹¤.

###  ğŸ“Œ ê¸°í•˜í•™ì  ì˜ë¯¸
- ì´ í•¨ìˆ˜ëŠ” ë‹¤ìŒ ìƒí™©ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤:
    - íšŒì „/ë°©í–¥(angle heading) ë¹„êµ
    - ë¡œë´‡ ê´€ì ˆ ê°ë„ wrap-around ì²˜ë¦¬
    - ì›í˜¸(arc) íŒŒë¼ë¯¸í„° ì°¨ì´ ê³„ì‚°
    - ê°ë„ ê¸°ë°˜ ë³´ê°„(slerp, arc interpolation)
    - ì‚¼ê°í•¨ìˆ˜ ê¸°ë°˜ ì•Œê³ ë¦¬ì¦˜ ì•ˆì •í™”
    - 0Â° â†” 360Â° ê²½ê³„ ë¬¸ì œ í•´ê²°
- ì˜ˆì‹œ:
    - a = 350Â°, b = 10Â°
    - ë‹¨ìˆœ ì°¨ì´ = 340Â°
    - ì‹¤ì œ ìµœë‹¨ ì°¨ì´ = âˆ’20Â°
- a = 5Â°, b = 355Â°
    - ë‹¨ìˆœ ì°¨ì´ = âˆ’350Â°
    - ì‹¤ì œ ìµœë‹¨ ì°¨ì´ = +10Â°
    - ì´ í•¨ìˆ˜ëŠ” ë°”ë¡œ ê·¸ **ì˜¬ë°”ë¥¸** ì°¨ì´ë¥¼ ë°˜í™˜í•œë‹¤.


```rust
#[inline]
pub fn on_angle_2pi_difference(a: f64, b: f64) -> f64 {
    if !a.is_finite() || !b.is_finite() {
        return f64::NAN;
    }
    let mut d = (a - b) % TAU;
    if d > PI {
        d -= TAU;
    }
    if d < -PI {
        d += TAU;
    }
    d
}
```
```rust
#[inline]
pub fn on_angle_2pi_distance(a: f64, b: f64) -> f64 {
    on_angle_2pi_difference(a, b).abs()
}
```
---
