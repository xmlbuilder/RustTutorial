# ë¹„ê· ë“± ë¶„í• 

- ì´ ë‘ í•¨ìˆ˜ëŠ” ëª¨ë‘ êµ¬ê°„ì„ ë‚˜ëˆ„ëŠ” ë°©ì‹ì—ì„œ **ë¹„ê· ë“± ë¶„í• (biased division)** ì„ êµ¬í˜„í•©ë‹ˆë‹¤.  
- ìˆ˜í•™ì ìœ¼ë¡œëŠ” ì²« ë²ˆì§¸ëŠ” ê¸°í•˜ê¸‰ìˆ˜ì  ë¶„í• (geometric spacing), ë‘ ë²ˆì§¸ëŠ” ëˆ„ì ë¶„í¬í•¨ìˆ˜(CDF) ê¸°ë°˜ ë¶„í• ì…ë‹ˆë‹¤.  
- ì•„ë˜ì— ìˆ˜ì‹ê³¼ í•¨ê»˜ ë‹¨ê³„ë³„ë¡œ ì„¤ëª….  

## ğŸ“ 1. on_generate_biased_divisions: ê¸°í•˜ê¸‰ìˆ˜ì  ë¶„í• 

### ì†ŒìŠ¤ ì½”ë“œ
```rust
/// One-sided geometric division
pub fn on_generate_biased_divisions(
    total_length: f64,
    num_div: i32,
    mut r: f64,
    small_at_left: bool,
) -> Vec<f64> {
    let n = num_div.max(0) as usize;
    let mut lt = vec![0.0; n + 1];
    if n == 0 {
        return lt;
    }
    if r <= 0.0 {
        r = 1.0;
    }

    let mut flip = false;
    if r < 1.0 {
        r = 1.0 / r;
        flip = true;
    }
    let left_small = small_at_left ^ flip;

    if (r - 1.0).abs() < 1e-12 {
        let a = total_length / (n as f64);
        for i in 0..=n {
            lt[i] = a * (i as f64);
        }
        return lt;
    }

    let a = total_length / ((r.powi(num_div.max(0)) - 1.0) / (r - 1.0));

    if left_small {
        lt[0] = 0.0;
        for i in 1..=n {
            lt[i] = a * (r.powi(i as i32) - 1.0) / (r - 1.0);
        }
    } else {
        let mut base = vec![0.0; n + 1];
        for i in 1..=n {
            base[i] = a * (r.powi(i as i32) - 1.0) / (r - 1.0);
        }
        for i in 0..=n {
            lt[i] = total_length - base[n - i];
        }
    }
    lt[0] = 0.0;
    lt[n] = total_length;
    lt
}
```

### âœ… ëª©ì 
- ê¸¸ì´ Lë¥¼ nê°œì˜ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆ„ë˜, í•œìª½ ëì´ ë” ì´˜ì´˜í•˜ê²Œ ë¶„í• ë˜ë„ë¡ í•©ë‹ˆë‹¤.  
- ë¹„ìœ¨ r>1ì¼ ë•Œ, ê° êµ¬ê°„ ê¸¸ì´ëŠ” ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í•©ë‹ˆë‹¤.

### ğŸ”¢ ìˆ˜ì‹ ë‹¨ê³„
#### â‘  ë“±ë¶„ì¼ ê²½ìš° $(r\approx 1)$

$$
a=\frac{L}{n}\quad \mathrm{(interval\  length)}
$$

$$
x_i=a\cdot i\quad \mathrm{for\  }i=0..n
$$

#### â‘¡ ê¸°í•˜ê¸‰ìˆ˜ì  ë¶„í• ì¼ ê²½ìš° $(r\neq 1)$
- ì´ ê¸¸ì´ LëŠ” ë‹¤ìŒ í•©ìœ¼ë¡œ í‘œí˜„ë©ë‹ˆë‹¤:

$$
L=a\cdot \left( 1+r+r^2+\dots +r^{n-1}\right) =a\cdot \frac{r^n-1}{r-1}
$$

- ë”°ë¼ì„œ ì²« êµ¬ê°„ ê¸¸ì´ aëŠ”:

$$
a=\frac{L(r-1)}{r^n-1}
$$

- ëˆ„ì  ìœ„ì¹˜ëŠ”:

$$
x_i=a\cdot \frac{r^i-1}{r-1}\quad \mathrm{for\  }i=0..n
$$

- ë§Œì•½ ì‘ì€ êµ¬ê°„ì´ ì˜¤ë¥¸ìª½ì— ìˆì–´ì•¼ í•œë‹¤ë©´:

$$
x_i=L-a\cdot \frac{r^{n-i}-1}{r-1}
$$


### âœ… ìˆ˜í•™ì  ì˜ë¯¸
- r>1: ì™¼ìª½ì´ ì´˜ì´˜í•˜ê³  ì˜¤ë¥¸ìª½ì´ ë„“ìŒ
- r<1: ì˜¤ë¥¸ìª½ì´ ì´˜ì´˜í•˜ê³  ì™¼ìª½ì´ ë„“ìŒ â†’ ë‚´ë¶€ì ìœ¼ë¡œ $r=1/r$ ë¡œ ë³€í™˜
- small_at_left í”Œë˜ê·¸ì™€ rì˜ í¬ê¸°ì— ë”°ë¼ ë°©í–¥ì´ ê²°ì •ë¨

---

## ğŸ“ 2. on_generate_smooth_biased_divisions: CDF ê¸°ë°˜ ë¶€ë“œëŸ¬ìš´ ë¶„í• 

### ì†ŒìŠ¤ ì½”ë“œ
```rust
/// Left/right skewed â€œsmoothâ€ split (Power/Exp CDF)
/// method: 0=Power(t^gamma), 1=Exp((e^{kt}-1)/(e^k-1))
pub fn on_generate_smooth_biased_divisions(
    l: f64,
    n: i32,
    strength: f64,
    small_at_left: bool,
    method: i32,
) -> Vec<f64> {
    let n = n.max(0) as usize;
    let mut x = vec![0.0; n + 1];
    if n == 0 {
        return x;
    }

    let f_power = |t: f64| -> f64 {
        let gamma = if strength <= 0.0 { 1.0 } else { strength };
        t.clamp(0.0, 1.0).powf(gamma)
    };
    let f_exp = |t: f64| -> f64 {
        let t = t.clamp(0.0, 1.0);
        let k = strength;
        if k.abs() < 1e-12 {
            return t;
        }
        let ek = k.exp();
        let ekt = (k * t).exp();
        (ekt - 1.0) / (ek - 1.0)
    };
    let f = |t: f64| -> f64 { if method == 0 { f_power(t) } else { f_exp(t) } };

    for i in 0..=n {
        let t = (i as f64) / (n as f64);
        x[i] = if small_at_left {
            l * f(t)
        } else {
            l * (1.0 - f(1.0 - t))
        };
    }
    x[0] = 0.0;
    x[n] = l;
    x
}
```

### âœ… ëª©ì 
- ê¸¸ì´ Lë¥¼ nê°œì˜ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆ„ë˜, ë¶€ë“œëŸ½ê²Œ í¸í–¥ëœ ë¶„í• ì„ êµ¬í˜„í•©ë‹ˆë‹¤.  
- Power í•¨ìˆ˜ ë˜ëŠ” ì§€ìˆ˜ í•¨ìˆ˜ ê¸°ë°˜ ëˆ„ì  ë¶„í¬(CDF)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

### ğŸ”¢ ìˆ˜ì‹ ë‹¨ê³„
#### â‘  Power ë¶„í•  (method = 0)
- í•¨ìˆ˜ ì •ì˜:

$$
f(t)=t^{\gamma }\quad \mathrm{where\  }\gamma >0
$$


- ìœ„ì¹˜ ê³„ì‚°:

$$
x_i=L\cdot f\left( \frac{i}{n}\right) =L\cdot \left( \frac{i}{n}\right) ^{\gamma }
$$


- ë°˜ëŒ€ ë°©í–¥ì¼ ê²½ìš°:

$$
x_i=L\cdot \left( 1-\left( 1-\frac{i}{n}\right) ^{\gamma }\right)
$$


#### â‘¡ Exponential ë¶„í•  (method = 1)
- í•¨ìˆ˜ ì •ì˜:

$$
f(t)=\frac{e^{kt}-1}{e^k-1}
$$

- ìœ„ì¹˜ ê³„ì‚°:

$$
x_i=L\cdot f\left( \frac{i}{n}\right) \quad \mathrm{or}\quad x_i=L\cdot \left( 1-f\left( 1-\frac{i}{n}\right) \right)
$$

- k>0: ì™¼ìª½ì´ ì´˜ì´˜
- k<0: ì˜¤ë¥¸ìª½ì´ ì´˜ì´˜
- k=0: ê· ë“± ë¶„í• 

## ğŸ“Œ ìš”ì•½ ë¹„êµ

| í•­ëª©                  | generate_biased_divisions                          | generate_smooth_biased_divisions                                      |
|-----------------------|----------------------------------------------------|------------------------------------------------------------------------|
| ë¶„í•  ìˆ˜ì‹             | $x_i = a \cdot \frac{r^i - 1}{r - 1}$          | $x_i = L \cdot f(t)$,<br> $f(t) = t^{\gamma}$ ë˜ëŠ” $\frac{e^{kt} - 1}{e^k - 1}$ |
| ì œì–´ ë³€ìˆ˜             | `small_at_left`, $r$                           | `small_at_left`, `strength`                                           |
| ê· ë“± ì¡°ê±´             | $r \approx 1$                                  | $\gamma = 1$, $k = 0$                                          |

---


