# ConvexPolygon2DClipper

ConvexPolygon2DClipper 및 관련 박스 클리핑 함수들의 수학적 원리, 활용 분야, 핵심 수식, 그리고 함수별 역할 요약을 정리한 내용입니다.

## 🧠 수학적 원리 요약
이 코드는 Sutherland–Hodgman 알고리즘을 기반으로 한 2D 다각형 클리핑 구현입니다.  
주어진 **클리핑 영역(박스 또는 볼록 다각형)** 에 대해 대상 다각형(subject polygon)을 잘라내는 방식입니다.

### 🔹 핵심 개념
- 클리핑 영역: CCW 방향의 볼록 다각형 또는 축 정렬 박스
- 교차점 계산: 두 선분의 교차점은 다음 수식으로 계산됨

$$
t=\frac{(a_x-s_x)\cdot dy_2-(a_y-s_y)\cdot dx_2}{dx_1\cdot dy_2-dy_1\cdot dx_2}
$$

$$
\mathrm{교차점}=s+t\cdot (e-s)
$$

- 내부 판정: 점 p가 엣지 의 왼쪽에 있으면 내부

$$
\mathrm{cross_{\mathnormal{z}}}=(b_x-a_x)(p_y-a_y)-(b_y-a_y)(p_x-a_x)
$$


| 함수 이름                      | 역할 설명                                                                 |
|-------------------------------|----------------------------------------------------------------------------|
| ConvexPolygon2DClipper::new   | tolerance를 설정하고 클리퍼 구조체를 초기화                                |
| set_clip_polygon              | 클리핑 다각형 설정 (CCW 정규화 및 볼록성 검사 포함)                        |
| clip_polygon                  | 단일 다각형을 클리핑 다각형에 대해 잘라냄                                 |
| clip_polygons                 | 다중 다각형을 클리핑 다각형에 대해 반복적으로 잘라냄                       |
| signed_area_static            | 다각형의 사인드 면적을 계산하여 방향성(CW/CCW) 판단에 활용                  |
| inside_edge                   | 점이 주어진 엣지 기준으로 내부에 있는지 판정 (벡터 외적 기반)              |
| intersect_edge                | 두 선분의 교차점을 계산 (Sutherland–Hodgman 알고리즘 핵심 연산)            |
| clip_against_edge             | 주어진 엣지에 대해 다각형을 클리핑 (in→in, in→out, out→in 처리)            |
| clip_polygon_by_box           | 축 정렬 사각형 박스에 대해 단일 다각형을 클리핑                            |
| clip_polygons_with_box        | 다중 다각형을 박스에 대해 반복적으로 클리핑                                |
| clip_polygon_to_poly          | CCW 볼록 다각형에 대해 단일 다각형을 클리핑                                |
| clip_polygons_to_poly         | CCW 볼록 다각형에 대해 다중 다각형을 클리핑                                |


| 분야             | 적용 예시                                           | 기대 효과 또는 목적                         |
|------------------|-----------------------------------------------------|----------------------------------------------|
| CAD/CAE          | 모델 단면 추출, 경계 기반 메시 클리핑               | 시야 제한, 경계 조건 설정, 해석 영역 분할    |
| GIS/지리정보     | 지도 경계 내 도형 클리핑, 행정구역 기반 필터링      | 공간 데이터 정제, 시각화 최적화              |
| 컴퓨터 그래픽스  | 뷰포트 클리핑, UI 요소 잘라내기, 렌더링 영역 제한    | 성능 향상, 시각적 정확도 확보                |
| 시뮬레이션/물리  | 충돌 영역 클리핑, 유효 영역 설정                    | 계산량 감소, 경계 조건 적용                  |
| 이미지 처리      | ROI 추출, 마스크 기반 클리핑                        | 관심 영역 분석, 배경 제거                    |
| 로보틱스/경로계획| 장애물 영역 클리핑, 센서 시야 제한                  | 안전 경로 탐색, 시야 기반 판단               |



## ✏️ 수식 요약
### 1. 교차점 계산

$$
t=\frac{(a_x-s_x)\cdot dy_2-(a_y-s_y)\cdot dx_2}{dx_1\cdot dy_2-dy_1\cdot dx_2}\quad \Rightarrow \quad P=s+t\cdot (e-s)
$$

### 2. 내부 판정 (벡터 외적)

$$
\mathrm{cross_{\mathnormal{z}}}=(b_x-a_x)(p_y-a_y)-(b_y-a_y)(p_x-a_x)\quad \Rightarrow \quad \mathrm{inside\  if\  cross_{\mathnormal{z}}}\geq -\mathrm{tol}
$$

### 3. 사인드 면적

$$
A=\frac{1}{2}\sum _{i=0}^{n-1}(x_iy_{i+1}-x_{i+1}y_i)
$$

이제 이 클리핑 모듈은 수학적으로 안정적이며, 다양한 실무 분야에 적용 가능합니다.


----

# 가능한 형상

ConvexPolygon2DClipper는 이름 그대로 **볼록 다각형(convex polygon)** 을 기준으로 클리핑을 수행하는 도구입니다.

별 모양처럼 오목한 형상은 안 되지만, 이 도구는 정확하고 빠른 클리핑이 필요한 상황에서 매우 유용하게 쓰입니다.

## 🎯 ConvexPolygon2DClipper의 주요 용도
### 1. 2D 그래픽 클리핑
- UI 요소, 게임 오브젝트, 시각화 영역 등에서 볼록한 마스크 영역으로 클리핑할 때 사용
- 예: 원형, 육각형, 사각형, 볼록 다각형 등
### 2. 물리 시뮬레이션에서 충돌 영역 처리
- 볼록 다각형은 충돌 판정이 빠르고 안정적
- 클리핑으로 충돌 영역을 제한하거나 잘라낼 수 있음
### 3. 지리 정보 시스템(GIS)
- 지도에서 볼록한 구역(행정구역, 탐색 영역 등)을 기준으로
포인트나 경로를 클리핑할 때 사용
### 4. 컴퓨터 비전 / 이미지 처리
- 볼록한 ROI(Region of Interest)를 기준으로 픽셀, 객체, 경계선 등을 잘라낼 때
### 5. 메시 처리 및 렌더링 최적화
- 볼록 다각형 기반 메시를 클리핑하여 렌더링 범위를 제한하거나 시야 밖 제거

## ✅ 왜 Convex만 지원할까?
- 볼록 다각형은 수학적으로 간단하고 계산이 빠름
- 선분 교차 여부, 내부 판정 등이 안정적
- 오목 다각형은 복잡한 분할, 교차 판정이 필요함

## 📌 요약
| ✅ 특징         | 💡 설명                                      | 🎯 활용 분야                     |
|----------------|---------------------------------------------|----------------------------------|
| 빠르고 안정적  | 볼록 다각형만 처리하므로 계산이 단순하고 예외가 적음 | UI 클리핑, 물리 시뮬레이션, GIS |
| 제한적 구조    | 오목 다각형, 별 모양, 곡선은 직접 처리 불가       | 복잡한 형상은 분할 또는 근사 필요 |
| 수학적 명확성  | 내부 판정, 교차 여부가 명확하게 정의됨           | 메시 처리, 렌더링 최적화, 시야 제한 |

---


