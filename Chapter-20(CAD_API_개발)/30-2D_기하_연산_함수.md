# 2D 기하 연산 함수
이 코드들은 2D/3D 공간에서의 기하 연산을 다루며, 각 함수는 수학적으로 명확한 목적을 가지고 있습니다.  
아래에 함수별 수학적 의미와 알고리즘 흐름을 단계적으로 정리했습니다.

## 📦 함수 요약 표

| 함수 이름                          | 주요 기능 설명                              | 수학적/기하학적 의미 또는 알고리즘 핵심             |
|-----------------------------------|---------------------------------------------|-----------------------------------------------------|
| `on_get_sampling_2d`              | 2D 점 집합에서 균일 샘플링                   | $k = 4 + \sqrt[3]{n}$, 등간격 추출              |
| `on_get_sampling_3d`              | 3D 점 집합에서 균일 샘플링                   | 동일 방식으로 3D 점 샘플링                          |
| `on_offset_point`                | 두 점 사이 방향으로 거리만큼 연장된 점 계산 | 단위 벡터 방향으로 거리만큼 이동                    |
| `on_sort_doubles`                | 실수 배열 정렬                               | `total_cmp` 기반 안정적 정렬                        |
| `on_cull_doubles`                | 실수 배열에서 근접값 제거                    | $|a_i - a_{i-1}| < \text{tol}$ 제거              |
| `on_is_point_on_segment_2d`      | 점이 선분 위에 있는지 판별                   | 투영 비율 $t \in [0,1]$, 거리 < TOL             |
| `on_point_in_rectangle`          | 점이 직사각형 내부/외부/변 위인지 판별       | 사각형 변 위 체크 + 내부 좌표 범위 조건             |
| `on_point_in_triangle_2d_scalars`| 점이 삼각형 내부에 있는지 판별               | 벡터 내적 기반 $u, v$ 계산                      |
| `on_is_polygon_convex`           | 다각형이 볼록한지 판별                       | 외적 부호 일관성 확인                              |
| `on_is_point_inside_box`         | 3D 박스 내부에 점이 있는지 판별              | 열린/닫힌 조건에 따라 좌표 범위 비교                |
| `on_determinant3_vectors`         | 정육면체의 부피           | 체적을 계산함                |
## 📌 1. on_get_sampling_2d / on_get_sampling_3d
### ✳️ 목적
- 큰 점 집합에서 균일하게 샘플링된 일부 점을 추출
### 📐 수학적 원리
- 전체 개수 n에서 샘플 개수 $k=4+\sqrt[3]{n}$
- 간격 $r=\lfloor n/k\rfloor$ 
- $i\in [0,k)$ 에 대해 $\mathrm{sample}[i]=\mathrm{data}[i\cdot r]$

## 📌 2. on_offset_point
### ✳️ 목적
- 두 점 사이 방향으로 일정 거리만큼 연장된 점 계산
### 📐 수식
- 벡터 $\vec {v}=p_2-p_1$
- 단위 벡터 $\hat {v}=\frac{\vec {v}}{|\vec {v}|}$
- 결과 $p=p_2+\mathrm{length}\cdot \hat {v}$

## 📌 3. on_sort_doubles
### ✳️ 목적
- 실수 배열을 오름차순 또는 내림차순 정렬
### 📐 수학적 의미
- 정렬 알고리즘은 O(n\log n) 복잡도
- total_cmp는 IEEE-754 기준으로 NaN, ±0 등도 안정적으로 비교

## 📌 4. on_cull_doubles
### ✳️ 목적
- 실수 배열에서 근접한 값 제거 (중복 제거)
### 📐 수학적 원리
- 정렬 후 인접한 값 $|a_i-a_{i-1}|<\mathrm{tol}$ 제거
- $\mathrm{tol}\geq \sqrt{\epsilon }$ (수치 안정성 확보)

## 📌 5. on_is_point_on_segment_2d
### ✳️ 목적
- 점이 선분 위에 있는지 판별
### 📐 수식
- 선분 방향 벡터 $\vec {a}=p_1-p_0$
- 투영 비율 $t=\frac{(p-p_0)\cdot \vec {a}}{|\vec {a}|^2}$
- $t\in [0,1]$ 이고, 거리 $\frac{||p-\mathrm{proj}||}{|\vec {a}|}<\mathrm{TOL}$

## 📌 6. on_point_in_rectangle
### ✳️ 목적
- 점이 직사각형 내부, 외부, 또는 변 위에 있는지 판별
### 📐 수학적 원리
- 변 위 판별: on_is_point_on_segment_2d
- 내부 판별: $x\in (x_{\mathrm{min}},x_{\mathrm{max}}),y\in (y_{\mathrm{min}},y_{\mathrm{max}})$

## 📌 7. on_point_in_triangle_2d_scalars
### ✳️ 목적
- 점이 삼각형 내부에 있는지 판별 (벡터 방식)
### 📐 수식
- 벡터 $\vec {v_0}=A_3-A_1$, $\vec {v_1}=A_2-A_1$, $\vec {v_2}=P-A_1$
- 내적 기반으로 u,v 계산:

$$
u=\frac{(v_1\cdot v_1)(v_0\cdot v_2)-(v_0\cdot v_1)(v_1\cdot v_2)}{\mathrm{denom}},\quad v=\frac{(v_0\cdot v_0)(v_1\cdot v_2)-(v_0\cdot v_1)(v_0\cdot v_2)}{\mathrm{denom}}
$$

- 조건: $u>0,v>0,u+v<1$

## 📌 8. on_is_polygon_convex
### ✳️ 목적
- 다각형이 볼록한지 판별
### 📐 수학적 원리
- 각 꼭짓점에서 외적 $\vec {u}\times \vec {v}$ 의 부호가 일정해야 함
- 외적: $u_xv_y-u_yv_x$
- 부호가 바뀌면 오목

## 📌 9. on_is_point_inside_box
### ✳️ 목적
- 3D 박스 내부에 점이 있는지 판별
### 📐 수학적 원리
- 열린 박스: $p_i>\mathrm{min_{\mathnormal{i}}}-\mathrm{inflate}\wedge p_i<\mathrm{max_{\mathnormal{i}}}+\mathrm{inflate}$
- 닫힌 박스: $p_i\geq \mathrm{min_{\mathnormal{i}}}-\mathrm{inflate}\wedge p_i\leq \mathrm{max_{\mathnormal{i}}}+\mathrm{inflate}$


## 📌 10. on_determinant3_vectors
### 📐 수학적 정의
### 🔢 행렬 구성
세 벡터 $\vec {v}_1$, $\vec {v}_2$, $\vec {v}_3$ 를 각각 행으로 갖는 3×3 행렬:

$$
M=\left[ \begin{matrix}v_1.x&v_1.y&v_1.z\\ , v_2.x&v_2.y&v_2.z\\ , v_3.x&v_3.y&v_3.z\end{matrix}\right]
$$

- 이 함수는 이 행렬의 행렬식을 계산합니다.

### ✳️ 행렬식 공식
3×3 행렬의 행렬식은 다음과 같이 계산됩니다:  

$$
\mathrm{det}(M)=v_1.x\cdot (v_2.y\cdot v_3.z-v_2.z\cdot v_3.y)-v_1.y\cdot (v_2.x\cdot v_3.z-v_2.z\cdot v_3.x)+v_1.z\cdot (v_2.x\cdot v_3.y-v_2.y\cdot v_3.x)
$$

이 식은 정확히 함수 내부의 연산과 일치합니다.

### 📌 기하학적 의미
- 이 행렬식은 세 벡터가 만드는 평행육면체의 부피를 나타냅니다.
- 절댓값이 0이면 세 벡터가 같은 평면에 있음 → 선형 종속
- 양수/음수는 **오리엔테이션(방향성)**을 나타냅니다

### 🧪 예시
```rust
let v1 = Point::new(1.0, 0.0, 0.0);
let v2 = Point::new(0.0, 1.0, 0.0);
let v3 = Point::new(0.0, 0.0, 1.0);
let det = on_determinant3_vectors(v1, v2, v3); // 결과: 1.0
```
- 단위 벡터 3개로 구성된 정육면체의 부피는 1

---

